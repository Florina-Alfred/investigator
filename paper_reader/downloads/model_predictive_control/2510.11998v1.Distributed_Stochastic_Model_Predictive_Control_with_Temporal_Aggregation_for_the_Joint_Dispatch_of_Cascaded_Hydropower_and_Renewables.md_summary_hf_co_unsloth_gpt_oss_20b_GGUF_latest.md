**Title & Citation**  
*Distributed Stochastic Model Predictive Control with Temporal Aggregation for the Joint Dispatch of Cascaded Hydropower and Renewables*  
Luca Santosuosso, Sonja Wogrin – Institute of Electricity Economics and Energy Innovation, Graz University of Technology, Graz, Austria  
(Full text available under the authors’ email addresses).

---

## Abstract  
The paper proposes a real‑time optimal dispatch algorithm for a hybrid system that couples cascaded hydropower (CH) plants with wind and solar units, all bidding in the day‑ahead market.  
The authors reformulate the joint dispatch as a scenario‑based stochastic Model Predictive Control (MPC) and address the severe computational burden by:  

1. **Temporal‑Series Aggregation (TSA)** – only the horizon tail is aggregated, keeping the first few periods at original resolution.  
2. **Distributed Optimization** – the aggregated problem is split across assets and scenarios via an Alternating Direction Method of Multipliers (ADMM) consensus formulation.  

The resulting controller is proved to be an approximation of the full‑scale MPC, with lower and upper bounds on its objective value.  
Simulation on a realistic French CH‑vRES system (3 cascaded plants + 60 MW wind + 60 MW PV) shows a **42 % cut in execution time** and a **~37 % reduction in temporal dimensionality** while maintaining the same first‑stage decision quality.  

---

## 1. Introduction & Motivation  

- **Background** – Hydro plants, especially cascaded ones, are increasingly used as “flexibility” assets to counter vRES variability.  
- **Operational challenge** – Short‑term MPC is the dominant real‑time controller, but *high temporal resolution*, *interactive hydraulic dynamics*, *non‑convex plant models*, and *multi‑scenario* uncertainty impose fast but computationally heavy optimization.  
- **Existing solutions** – Dual, Benders, and augmented Lagrangian decomposition address asset or scenario coupling but never both *and* reduce the temporal dimension.  
- **TSA** in prior work reduces temporal size, yet guarantees are weak when storage and cascading constraints are present.  
- **Gap** – No method has combined *performance‑guaranteed TSA* with *distributed stochastic MPC* for CH‑vRES.  
- **Goal** – Provide a first‑stage decision‑quality guarantee while cutting computational load across *temporal, asset, and scenario* dimensions.  

---

## 2. Problem Statement  

- **System** – Hydropower plant \(n \in N\): turbines (discharge \(q^{tr}_{n}\)), barrage \(q^{br}_{n}\), reservoir forebay level \(l_{n}\).  
- **Dynamics** – Reservoir level evolution  
\[
l_{n,\omega,t+k|t}=l_{n,\omega,t+k-1|t}+\frac{\Delta}{S_n}(q^{tr}_{n,\omega,t+k|t}+q^{br}_{n,\omega,t+k|t}+q^{ext}_{n,\omega,t+k|t}),
\]  
with \(S_n\) surface area, \(\Delta\) sampling time.  
   - *Inflow* \(q^{ext}\) is uncertain, while upstream plant discharges enter via propagation delays \(\tau_{tr}^{n-1,n}\), \(\tau_{br}^{n-1,n}\).  
- **Constraints** – Upper‑relation bounds on discharges, head, reservoir level, and ramp limit \(\Delta^{tr}_n\).  
- **Power model** – Bilinear:  
\[
p^{h}_{n,\omega,t+k|t}=\frac{10^{-6} w g \eta_n}{q^{tr}_{n,\omega,t+k|t}\,h_{n,\omega,t+k|t}}\quad h_{n,\omega,t+k|t}=l_{n,\omega,t+k|t}-L_{tlr,n},
\]  
\(\eta_n\) turbine efficiency, \(w\) density, \(g\) gravity.  
   - **McCormick relaxation** replaces cross term by a convex envelope \([C_n h_n^{min},C_n h_n^{max}]\).  
- **vRES** – Forecasted generation \(\hat{P}^{vRES}_{\omega,t+k|t}\) is a *non‑controllable* input.  
- **Energy balance** –  
\[
\sum_n p^{h}_{n,\omega,t+k|t}+\hat{P}^{vRES}_{\omega,t+k|t}=P^E_{t+k|t}
,\]  
where \(P^E\) is the day‑ahead market offer.  
- **Objective** – Quadratic penalties on imbalance penalties and a reference‑tracking term for levels:  
\[
F(z)=\sum_{\omega,t+k|t}\Bigl(
\frac{(\hat{\pi}^{\uparrow}_{\omega,t+k|t})^2 \|\delta e^\uparrow_{\omega,t+k|t}\|^2+
\frac{(\hat{\pi}^{\downarrow}_{\omega,t+k|t})^2 \|\delta e^\downarrow_{\omega,t+k|t}\|^2\Bigr)
+ \alpha \|l_{n,\omega,t+k|t}-l^{ref}_{n,t+k|t}\|^2
\]  
with \(\alpha\) weighting.  

- **Full‑scale MPC** – Solve a QP over horizon \(K\) scenarios \(\Omega\), looped with rolling horizon.  

---

## 3. Methods / Approach  

### 3.A Centralised Stochastic MPC  

- Variables: turbine and barrage discharges, reservoir levels, and power output.  
- Decision vector \(z\) includes all plant variables for all scenarios and horizon steps.  
- **Objective** \(F(z)\) defined above.  
- **Constraints**: dynamics (1)-(2), bounds (3)-(6), power model (7) with McCormick (8)-(11), energy balance (17) and non‑anticipativity (19d).  
- Solve QP (19) at each time step \(t\).  

### 3.B Centralised MPC with Temporal Aggregation  

- **Goal** – Reduce temporal dimension via **TSA** applied only to *horizon tail*.  
- **Clustering** – Define representative periods \(R\) with mapping \(k\rightarrow r\).  Real periods \(K_r\) are grouped for each cluster.  
- **Aggregation** – Variables and constraints are averaged over each cluster, preserving resolution for first \(R-1\) periods.  
- **Aggregated problem** (21) is a QP over \(R\) periods.  

### 3.C Distributed MPC with Temporal Aggregation  

- **Distributed decomposition** uses consensus ADMM (22).  
   - **Global variables** \(z^G_{n,\omega}=[q^{tr}_{n,\omega},q^{br}_{n,\omega},p^{h}_{n,\omega}]\).  
   - **Local copies** \(\tilde{z}^G_{n,\omega}\).  
- **Consensus sub‑problems**  
   - **Energy‑balance sub‑problem** (22b) shares power balance as well as first‑stage non‑anticipativity.  
   - **Hydropower sub‑problems** (22c) per plant & scenario enforce dynamics & bounds.  
- **Consensus constraints** (22d) ensure equality of local and global copies.  
- **ADMM iterations** –  
   1. Local minimisation (23a) using \(A\) and Dα-preconditioned objective;  
   2. Global minimisation (23b);  
   3. Dual update (23c).  
- **Termination** – when objective change \< \(\bar{F}^{thr}\).  

### 3.D Objective Function Error Bounds  

- **Lower bound** – obtained by ADMM solution \( \bar{F}^\star\) (21).  
- **Upper bound** – Solve full‑scale (19) with first‑stage decisions \(u^\star_{n,t|t}\) fixed; remaining variables free by scenario, giving \(F^{UB}\).  
- **Algorithm 1** – High‑level routine iteratively increases number of representative periods \(R\) (by \(\gamma\)) until objective‑gap \(F^{UB}-F^{LB}\) \<\(\epsilon^{thr}\).  
- **Parameters** – Example values: \(\alpha=10\), \(\epsilon^{thr}=1\%\), \(\bar{F}^{thr}=0.001\%\), \(R_0=50\), \(\gamma=50\), \(\rho=1\), \(J=12\) (high‑level iterations), \(I=2000\) (ADMM iterations).  

---

## 4. Experiments / Data / Results  

### 4.A Case Study  

- **Location** – France (real system reproduced).  
- **Hydro** – 3 cascaded plants (capacities 160 MW, 120 MW, 180 MW).  
- **Plant specs** – \(q^{tr}\) limits [110;1600], [60;1200], [140;2200] m³/s; barrage limits 50 m³/s each; reservoir levels [120;123], [110;112], [95;98] m; tailrace 115, 105, 94 m; surface areas 3.13, 2.95, 2.34 km².  
- **Efficiency** – 90 % for all plants; turbine/barrage delays 100 s/60 s; ramp limit 300 m³/s.  
- **vRES** – 60 MW wind + 60 MW PV.  
- **Scenarios** – 40 scenarios updated every MPC step.  
- **Resolution** – 2‑min time step, 24‑h horizon (720 periods).  
- **Market offer** – fixed at 165 MWh.  
- **Implementation** – Gurobi 12.0.1 on Intel i7 (32 GB RAM).  

### 4.B Numerical Results  

| Item | Result |
|------|--------|
| **Objective bounds** (Fig. 5) | Lower bound converges to full‑scale cost within 9 iterations; 42.5 % reduction in temporal dimensionality (450 periods vs 720). |
| **Representative periods** | 250 periods recover exact first‑stage cost → 65 % temporal reduction. |
| **ADMM convergence** (Fig. 6) | Best \(\rho=1\) converges in < 50 iterations; \(\rho=3\) needs > 200 iterations. |
| **Execution time** | Average per‑iteration MPC: 262.2 s (distributed + TSA) vs 453.4 s (centralised full‑scale) → 42 % speed‑up. |
| **Dispatch behaviour** (Fig. 7) | Hydropower discharges above external inflow during high‑price periods, below during low‑price / high vRES periods, maintaining reservoir depth around reference. |

---

## 5. Discussion & Analysis  

- **Performance guarantees** – Theoretical lower bound (ADMM) and upper bound (scenario‑fixed full‑scale) confirm that the TSA‑based solution is at most *<1 %* sub‑optimality.  
- **TSA strategy** – Using fine resolution for the horizon first 19 periods, aggregated tail (≥441 periods) preserves first‑stage accuracy while drastically cutting variable count.  
- **ADMM consensus** – Decomposes the problem into \( |N|\times|\Omega|+1\) sub‑problems; parallel solve reduces wall‑clock time.  
- **Sensitivity** – ADMM step size \(\rho\) heavily impacts iteration count; parameter tuning required.  
- **Computational scaling** – Timing results demonstrate that worst‑case growth (time vs horizon) is linear for distributed version, while quadratic for full‑scale.  
- **Real‑world relevance** – Case study uses realistic plant data and vRES forecasts, proving applicability to operational settings.  

---

## 6. Conclusion & Future Work  

- **Contribution** – First controller that merges TSA (tail‑only) with distributed stochastic MPC (scenario/asset ADMM) for CH‑vRES dispatch, providing *theoretically validated* error bounds.  
- **Performance** – 42 % time saving, 37 % dimensionality reduction, ~1 % objective gap.  
- **Opportunities** – Extend to non‑convex dynamics, refine TSA for *exact* approximations, explore adaptive clustering of representative periods, investigate tighter ADMM convergence criteria, and apply to other hybrid energy systems (e.g., battery + wind).  

---

## 7. Key Claims & Contributions  

| Claim | Supporting Evidence |
|-------|---------------------|
| **TSA applied only to horizon tail preserves first‑stage action** | Fig. 5 shows <1 % gap; 250 periods recover same first‑stage cost. |
| **Distributed ADMM yields < 42 % execution time** | Table comparing 262.2 s vs 453.4 s per iteration. |
| **Global error bounds exist** | Theoretical properties of (21) give lower bound; algorithm 1 provides upper bound via fixed first‑stage decisions. |
| **Single‑step solution accuracy preserved** | Ex‑post dispatch (Fig. 7) demonstrates correct reservoir behaviour and market imbalance handling. |
| **Scalability across temporal, asset, scenario dimensions** | Decomposition yields \( |N|\times|\Omega|\) sub‑problems; Tour of problem size (45k variables to 27k after aggregation). |

---

## 8. Definitions & Key Terms  

| Term | Definition |
|------|------------|
| **CH‑vRES** | Cascaded hydropower + wind + solar units operating jointly in the day‑ahead market. |
| **MPC** | Model Predictive Control – an optimization horizon‑based control strategy. |
| **Scenario‑based** | Uncertainty represented by a finite set of realizations \(\Omega\). |
| **Temporal‑Series Aggregation (TSA)** | Clustering of high‑resolution time steps into representative periods (clusters) by averaging input data. |
| **McCormick Approximation** | Convex envelope that bounds a bilinear term \( xy \) from above and below using min/max bounds of \(x,y \). |
| **Consensus ADMM** | Optimization algorithm that handles global constraints via local sub‑problems and dual updates, enabling distributed solution. |
| **Hydropower Power Model** | \( p^h = 10^{-6} w g \eta q^{tr} h \), bilinear in turbine discharge and head. |
| **Inflow \(q^{ext}\)** | Uncertain external influx entering reservoir. |
| **Non‑anticipativity** | Constraint that decisions for scenario \(\omega\) at time \(t\) cannot depend on future scenario states. |
| **Upper Bound \(F^{UB}\)** | Full‑scale objective value with first‑stage decisions fixed from aggregated solution. |
| **Lower Bound \(F^{LB}\)** | Objective value from ADMM solution of aggregated problem. |
| **Posterim Upstream/Downstream** | Not used in this paper. |

---

## 9. Important Figures & Tables  

| Figure | Content & Significance |
|--------|------------------------|
| **Fig. 1** | McCormick envelope for bilinear term (illustrates convexification). |
| **Fig. 2** | Illustration of TSA: first R–1 periods kept; tail aggregated. |
| **Fig. 3** | Consensus graph of decomposed sub‑problems (assets × scenarios). |
| **Fig. 4** | Boxplots of hourly uncertainties (inflows, vRES, prices). Shows variability across scenarios. |
| **Fig. 5** | Upper vs lower objective bounds across Algorithm 1 iterations; demonstrates 1 % gap after 9 iterations. |
| **Fig. 6** | Convergence of ADMM for \(\rho=1\) vs \(\rho=3\); highlights ADMM sensitivity to step size. |
| **Fig. 7** | Example of ex‑post hydro discharge profile vs inflow and market price; confirms correct dispatch logic. |

---

## 10. Limitations & Open Questions  

- **Convexification Only** – Plant power model treated via McCormick; real hydro dynamics may introduce non‑convexities not captured.  
- **ADMM Tuning** – Step size \(\rho\) dramatically influences iteration count; no systematic auto‑tuning is provided.  
- **TSA Clustering** – Fixed number of clusters (γ steps); no a‑priori selection of cluster cardinality or cluster weighting.  
- **Scenario Count** – 40 scenarios used; impact of larger \(|\Omega|\) on performance is not reported.  
- **Market Model** – Only day‑ahead offer considered; ancillary services and real‑time balancing markets ignored.  
- **Scalability Beyond 3 Plants** – Implementation details for more than 10 plants not addressed.  

---

## 11. References to Original Sections  

| Content | Original Section |
|---------|-------------------|
| Problem formulation (dynamics, constraints, objective) | Section II & III‑A |
| TSA methodology | Section III‑B & Fig. 2 |
| Distributed ADMM decomposition | Section III‑C & Fig. 3 |
| Performance bounds derivation | Section III‑D |
| Case study description | Section IV‑A |
| Numerical results & figures | Section IV‑B |
| Conclusions | Section V |  

---

### Optional • Executive Summary (Key Takeaways)  

1. **Hybrid dispatch problem** cast as scenario‑based stochastic MPC.  
2. **Temporal‑series aggregation** applied only to horizon tail balances high‑resolution short‑term decisions.  
3. **Distributed decomposition** (ADMM consensus) across scenarios and assets decouples hydraulic and electrical constraints.  
4. **Theoretical bounds** guarantee that the controller is within <1 % of the full‑scale optimal cost.  
5. **Simulation** on realistic French CH‑vRES yields 42 % time saving and 37 % dimensionality reduction while maintaining dispatch fidelity.  

---