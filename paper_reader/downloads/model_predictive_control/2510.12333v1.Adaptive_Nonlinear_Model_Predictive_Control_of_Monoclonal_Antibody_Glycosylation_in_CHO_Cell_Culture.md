## Adaptive Nonlinear Model Predictive Control of Monoclonal Antibody Glycosylation in CHO Cell Culture

Yingjie Ma a , Jing Guo a,b , Alexis B. Dubs a , Krystian K. Ganko a and Richard D. Braatz a , ‚àó

a Massachusetts Institute of Technology, Cambridge, MA 02139, USA

b Polytechnique Montr√©al, Montr√©al, QC H3T 0A3, Canada

## ARTICLE INFO

Keywords : Glycosylation adaptive nonlinear model predictive control multiscale model CHO cell culture

## 1. Introduction

## ABSTRACT

N-glycosylation is a critical quality attribute of monoclonal antibodies (mAbs), the dominant class of biopharmaceuticals. Controlling glycosylation remains difficult due to intrinsic pathway complexity, limited online measurements, and a lack of tailored control strategies. This work applies an adaptive nonlinear model predictive control (ANMPC) framework to a fed-batch mAb production process, using a multiscale model that links extracellular conditions to intracellular Golgi reactions to predict glycan profiles. Model parameters are updated online as new measurements arrive, after which a shrinking-horizon optimization computes the control inputs; only the first control move is implemented each cycle. Case studies show that, with a minimal day-1 galactose excitation, ANMPC mitigates model-plant mismatch and achieves up to 130% and 96% higher performance than openloop optimization and state NMPC, respectively. Under more realistic conditions (partial measurement availability and longer preparation time), ANMPC maintains comparable performance, indicating robustness to practical limitations. Overall, the results demonstrate that ANMPC can actively shape glycan distributions in silico and offers a viable path toward closed-loop control of mAb glycosylation.

Monoclonal antibodies (mAbs) are among the highestrevenue biopharmaceuticals, representing US $217 billion of the global biopharmaceutical market (US $343 billion) in 2021 [46]. They are widely administered to treat cancer, infectious diseases, and inflammatory disorders [31]. The N-linked glycans attached to the Fc region of a mAb profoundly influence its bioactivity and therapeutic efficacy [16, 27]. Because the glycan distribution must remain within tight limits, regulatory guidelines classify glycosylation as a critical quality attribute (CQA) for mAb products [2]. Variations in core fucosylation and terminal galactosylation, for example, directly modulate antibody-dependent cellular cytotoxicity (ADCC) and complement-dependent cytotoxicity (CDC)-the primary mechanisms through which mAbs destroy target cells [15, 29, 38]. Conversely, an increased proportion of high-mannose glycans accelerates serum clearance and reduces therapeutic potency [9].

and glycosylation, which, unlike the earlier stages, do not rely on a nucleic acid template [39, 41]. Instead, glycosylation emerges from a non-template enzymatic network of thousands of coupled reactions in the endoplasmic reticulum and Golgi apparatus, all modulated by diverse intracellular factors [19]. Consequently, glycan biosynthesis and conjugation to the antibody frequently yield a heterogeneous mixture of glycoforms [41]. Overall, the inherent complexity of the glycosylation process, the lack of robust real-time glycan analytics, and the absence of dedicated control strategies have so far limited the implementation of online glycosylation control [41].

Although essential for mAb bioactivity and therapeutic efficacy, achieving a consistent batch-to-batch glycan profile remains a formidable challenge for biopharmaceutical manufacturers [7, 30, 40]. Chinese hamster ovary (CHO) cells are the industry workhorse for mAb production because they perform complex post-translational modifications and secrete proteins that are both human-compatible and biologically active [21]. The CHO-based production workflow comprises a sequence of template-driven steps-DNA transcription, mRNA translation-followed by protein folding

‚àó Corresponding author

adubs@mit.edu (A.B. Dubs); kkganko@mit.edu (K.K. Ganko); braatz@mit.edu (R.D. Braatz)

yingjma@mit.edu (Y. Ma); jing.guo@polymtl.ca (J. Guo);

Most published control strategies for mAb bioprocesses have targeted the productivity of mAb or the concentrations of extracellular metabolites (e.g., glucose, glutamine, lactate) rather than the glycan profile itself [4, 5, 23, 35, 36]. The emphasis on productivity reflects the historical absence of mechanistic models that couple extracellular conditions to the intracellular glycosylation network-yet maximizing titer (mAb concentration) can be at odds with meeting a specified glycan distribution. Seeking to reconcile this tradeoff, Ref. [47] investigated how dynamic feed profiles influence N-glycan quality, but their policies were still framed in terms of holding nutrient concentrations at preset levels rather than directly steering the glycosylation state space. Reference [48] introduced a model predictive control (MPC) scheme to maintain a target high-mannose (HM) fraction, but the underlying model only comprised a single manipulated variable and a single glycoform, limiting its ability to balance yield enhancement with multi-attribute quality specifications.

<!-- image -->

The emergence of multiscale mechanistic models that explicitly link extracellular metabolism to intracellular glycosylation has enabled high-fidelity open-loop optimizations

capable of simultaneously boosting product titer and shaping the glycan profile [17, 21]. Reference [21] validated their optimization experimentally, achieving an over 90% increase in the desired glycoform and underscoring the promise of this approach. Nevertheless, both studies generated feed trajectories offline; such open-loop policies are vulnerable to model-plant mismatch and unanticipated disturbances [34]. Embedding the resulting partial-differential-algebraic equation (PDAE) models directly in a nonlinear MPC (NMPC) framework remains computationally prohibitive-a single optimization may require 20 h [26] to 40 h [17]. To reduce this burden, several groups have linearized the multiscale model into a process-gain matrix and applied the resulting controller in fed-batch [24] and perfusion bioreactors [28], but such linearizations are accurate only near the operating point used for their construction [41], limiting their robustness for the wide excursions typical of industrial fed-batch or disturbance-prone perfusion processes.

In what follows, Section 2 describes the multiscale glycosylation model; Section 3 formulates the control problem; Section 4 presents the ANMPC framework; Section 5 examines actuator choices and demonstrates the algorithm through case studies; and Section 6 concludes.

A second challenge is parameter identification for the multiscale model. Adaptive MPC techniques-updating model parameters online from process data-have been used to address model uncertainty with promising results [11, 14, 33]. Motivated by these gaps, we develop an adaptive NMPC (ANMPC) controller for a fed-batch mAb bioreactor using the multiscale PDAE glycosylation model of Ref. [21]. At each sampling time, ANMPC updates model parameters using all available measurements and then recomputes the control moves via model-based optimization. To solve the resulting dynamic optimization and parameter estimation problems efficiently and robustly, we employ control-vector parameterization (CVP) with embedded simulations accelerated by a parallel quasi-steady-state (QSS) approach proposed in our previous work [26]. Case studies initialized from multiple parameter sets compare open-loop optimization, state NMPC, and ANMPC; ANMPC mitigates model-plant mismatch and achieves up to 130% higher penalized merit than the alternatives. We further evaluate ANMPC under more realistic measurement availability (no NSD measurements) and with a 4 h analytics/actuation delay, observing no material performance loss, which demonstrates robustness.

## 2. Glycosylation model

Figure 1 illustrates the three-level multiscale glycosylation model employed in this work:

- (1) Bioreactor-level cell culture model - predicts viable cell density, extracellular metabolite concentrations, specific productivity, and the concentrations of secreted mAb.
- (2) Intracellular nucleotide sugar donor (NSD) synthesis model - converts the extracellular metabolite information from the culture model into intracellular NSD using a detailed synthesis pathway and associated rate laws.
- (3) Golgi-level glycosylation reaction model - receives the NSDs as sugar donors and computes the fractional distribution of glycoforms leaving the secretory pathway via a network of enzyme-catalyzed reactions coupled with glycoprotein transport equations.

The overall structure follows Ref. [21] and is extended to incorporate manganese- and ammonia-dependent kinetics reported by Ref. [45]. Information propagates downstream from the extracellular environment through the NSD synthesis layer and to the Golgi reaction network, and the resulting NSDconsumption and glycoform flux then feeds back to the NSD synthesis model and cell culture model-closing the loop and capturing the two-way coupling between reactor conditions and intracellular glycosylation.

The multiscale model is formulated as a large-scale PDAEsystem that couples 30 ordinary differential equations (ODEs), 34 partial differential equations (PDEs), and numerous highly nonlinear algebraic relations. The remainder of this section introduces each submodel in turn.

## 2.1. Cell culture model

At the reactor scale, we employ an unstructured differential algebraic equation (DAE) model to describe cell growth, death, and metabolism [18, 21]. The dynamic balances for cell culture volume and cell populations are

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where ùëâ (L) is the cell culture volume, ùêπ in and ùêπ out (L h -1 ) are the inlet and outlet flow rates, ùëã and ùëã v (cells L -1 ) denote the total and viable cell densities, and ùúá and ùúá death (h -1 ) are the specific cell growth and death rates, respectively.

The viability is defined as the fraction of living cells:

<!-- formula-not-decoded -->

The specific growth ( ùúá ) and death ( ùúá death ) rates are determined by nutrient availability and by the buildup of inhibitory byproducts. Glucose and asparagine supply is growth-limiting, whereas lactate, ammonia, and uridine exert inhibitory effects-with ammonia and uridine also driving cell death. The rate expressions are

<!-- formula-not-decoded -->

Figure 1: Multiscale glycosylation model

<!-- image -->

<!-- formula-not-decoded -->

in mmolcell -1 h -1 for the remaining metabolites. Metabolites considered in the model include ammonia (Amm), asparagine (Asn), aspartate (Asp), glucose (Glc), galactose (Gal), glutamine (Gln), glutamate (Glu), lactose (Lac), and uridine (Urd). Figure 2 depicts the corresponding metabolic network, and the individual reaction rates are

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where ùúá max and ùúá death, max (h -1 ) are the maximum specific growth and death rates, respectively; ùëì lim and ùëì inh are the substrate-limiting and metabolite-inhibiting factors, respectively; ùêæ Glc and ùêæ Asn (mmolL -1 ) are the Monod halfsaturation constants for glucose and asparagine; ùêæ d,Amm and ùêæ d,Urd (mmolL -1 ) are the death constants for ammonia and uridine; ùêæ I,Amm , ùêæ I,Lac , and ùêæ I,Urd (mmolL -1 ) are inhibition constants for ammonia, lactate, and uridine; and [ Glc ] , [ Asn ] , [ Amm ] , [ Lac ] , and [ Urd ] (mmolL -1 ) denote the extracellular concentrations of glucose, asparagine, ammonia, lactose and uridine, respectively.

The extracellular mass balance for each metabolite is described by

<!-- formula-not-decoded -->

where [ Met ] in is the metabolite concentration in the feed stream, [ Met ] is its concentration in the culture, and their units are mgL -1 for mAb and mmolL -1 for the other metabolites. ùëû Met is the cell-specific production or consumption rate, which is expressed in pg cell -1 h -1 for mAb and

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

Figure 2: The metabolic reaction network in the cell culture. The start of an arrow refers to the reactant, while the end of the arrow denotes the product.

<!-- image -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

The extracellular mass balance equation for each glycoform GLY ùëñ is

(UDP-GlcNAc), and cytidine monophosphate N -acetylneuraminic acid (CMP-Neu5Ac). The reaction network, depicted in Figure 1b, comprises ùëÅ R1 enzyme-catalyzed steps whose stoichiometry is encoded in the matrix ùúà nsd . For each donor ùëñ ( ùëñ = 1 , ‚Ä¶ , ùëÅ NSD = 7) , the mass balance is

<!-- formula-not-decoded -->

where [ NSD intra ùëñ ] (mmolL -1 ) is the intracellular concentration of donor ùëñ ; ùëü nsd ùëó ( mmolL -1 h -1 ) is the rate of a reaction ùëó ; and the sink terms ùëì hcp ‚àï lipid NSD ùëñ , ùëì precursor NSD ùëñ , and ùëì glyc NSD ùëñ ( mmolL -1 h -1 ) are consumption rates of the donor for host cell protein and glycolipid synthesis, precursor oligosaccharide assembly, and N-linked glycosylation, respectively. All reaction rates follow Michaelis-Menten kinetics that depend on the intracellular NSD concentrations together with extracellular glucose, galactose, and uridine concentrations and the intracellular glutamine level. The explicit rates are

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

In these expressions, the model parameters to be estimated include the yield coefficients ùëå ùëã Met ( cell mmol -1 ) , maintenance terms ùëö Met ( mmolcell -1 h -1 ) for metabolites excluding mAb, maintenance term ùëö mAb ( pg cell -1 h -1 ) for mAb, the fraction ùëì Gal (-), cross-yield ratios ùëå Met1 ‚àï Met2 ( mmolmmol -1 ) , saturation or inhibition constants ùêæ Met (mmolL -1 ), the empirical limits Lac max 1 and Lac max 2 (mmolL -1 ), and the product formation yield ùëå mAb ùëã ( pg cell -1 ) .

<!-- formula-not-decoded -->

where [ GLY extra ùëñ ] ( mgL -1 ) is the extracellular concentration of glycoform GLY ùëñ , and ùëå intra ùëñ = [ GLY intra ùëñ ]‚àï[ mAb intra ] is its intracellular fractional abundance. Here, the intracellular glycoform concentration [ GLY intra ùëñ ] ( ¬µ molL -1 ) is obtained from the Golgi model, while the total intracellular mAb level [ mAb intra ] ( ¬µ molL -1 ) is approximately 94 ¬µ molL -1 [20]. By analogy, the extracellular fractional abundance is ùëå extra ùëñ = [ GLY extra ùëñ ]‚àï[ mAb ] .

## 2.2. NSD synthesis model

NSDs provide monosaccharides for the glycosylation reactions, and they are synthesized inside the cells. Therefore, the NSD synthesis model consisting of a DAE system is used to track the intracellular concentrations of seven monosaccharide donors: guanosine diphosphate mannose (GDP-Man), guanosine diphosphate fucose (GDP-Fuc), uridine diphosphate galactose (UDP-Gal), uridine diphosphate glucose (UDP-Glc), uridine diphosphate N -acetylgalactosamine (UDP-GalNAc), uridine diphosphate N -acetylglucosamine

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

(29) Additional intracellular fluxes for each NSD ùëñ are

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where ùëâ max ,ùëó ( mmolL -1 h -1 ) is the maximum turnover rate of reaction ùëó ; ùêæùëÄùëó comp (mmolL -1 ) is the Michaelis constant of a component (metabolite or NSD) in reaction ùëó ; KI ùëó (mmolL -1 ) is the corresponding inhibition constant; and ùêæ regulator (mmolL -1 ) is introduced so that the factor [ Gal ] [ Gal ] + ùêæ regulator becomes zero when extracellular Gal is absent.

The intracellular glutamine concentration (mmol L -1 ) in (23) is estimated through

Gln intra = ùëì Gln [ Gln ] , where ùëì Gln is a constant parameter to connect intracellular Gln concentration with its extracellular counterpart.

<!-- formula-not-decoded -->

The NSD synthesis reaction rates that depend on Urd or Gal are

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where ùêæ TP ,ùëñ (mmolL -1 ) is the transport protein saturation constant for NSD ùëñ ; ùúà hcp ‚àï lipid ùëñ ( mmolcell -1 ) and ùúà precursor ùëñ (mmol pg -1 ) are the stoichiometric requirements for host cell protein/glycolipid synthesis and precursor oligosaccharide assembly, respectively; ùëâ cell ( Lcell -1 ) is the specific cell volume; and the NSD ùëñ consumption rate in glycosylation reactions ùëü glyc ùëñ ( mmolL -1 h -1 ) is [21]

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where vel golgi ( Golgi length min -1 ) is the length-normalized transit velocity, ùëâ golgi ( Lcell -1 ) is the Golgi volume, ùë£ ùëñ,ùëó is the number of NSD ùëñ molecules required for one oligosaccharide ùëó molecule, [ OS ùëó ]( ùëß ) (mmolL -1 ) is the oligosaccharide concentration at axial position ùëß (with ùëß = 0 at entry and ùëß = 1 at exit), and MW mAb is the molecular weight of mAb ( 165 √ó 10 3 g mol -1 ) .

## 2.3. Golgi model

The Golgi model predicts the intracellular glycoform distribution using a dynamic plug flow reactor (PFR) representation of the Golgi apparatus, formulated as a PDAE system [42, 21]. The spatiotemporal balance for each oligosaccharide OS ùëñ is

<!-- formula-not-decoded -->

where [ OS ùëñ ] ( ¬µ molL -1 ) is the local concentration of OS ùëñ in the Golgi apparatus, ùëü ùëó ( ¬µ molL -1 min -1 ) is the rate of reaction ùëó , ùúà ùëñ,ùëó is the stoichiometric coefficient of OS ùëñ in reaction ùëó , and ùëÅùëÖ 2 is the total number of glycosylation reactions. The glycosylation reaction network involving 33 oligosaccharides and 43 reactions is depicted in Figure 3 [45].

The glycosylation reaction rates ùëü ùëó fall into three mechanistic classes [42, 45]:

## ANMPC of mAb Glycosylation

Figure 3: The glycosylation reaction network in the Golgi apparatus.

<!-- image -->

- (i) Michaelis-Menten kinetics - used for enzymes Man I and Man II-catalyzed reactions

<!-- formula-not-decoded -->

- (ii) Sequential order Bi-Bi kinetics - used for enzymes GnT I, GnT II, and GalT-catalyzed reactions

<!-- formula-not-decoded -->

- (iii) Random-order Bi-Bi kinetics - used for enzymes FucT- and SiaT-catalyzed reactions

<!-- formula-not-decoded -->

In these expressions, OS ùëñ and OS ùëñ +1 are the reactant and product of reaction ùëó , respectively; the set { OS ùëò ‚à£ ùëò = 1 , 2 , ‚Ä¶ , ùëÅ C } contains every oligosaccharide that can bind to the enzyme ùê∏ùëó ; ùêæ enz ùëë,ùëñ and ùêæ enz ùëë,ùëò (mmolL -1 ) are the dissociation constants for OS ùëñ and OS ùëò bound to the enzyme enz ‚àà { Man I , Man II , GnT I , GnT II , GalT , FucT , SiaT } , respectively; ùêæ enz ùëë,ùëß and ùêæ enz ùëë,ùëõ (mmolL -1 ) are the dissociation constants for nucleotide sugar donor NSD ùëß and nucleotide Nuc ùëõ bound to the enzyme enz, where ùëõ ‚àà {1 , 2 , 3 , 4} ; ùêæ enz ùëë, Mn refers to the dissociation constants for manganese bound to enzymes enz ‚àà { GnT I , GnT II , GalT } ; [ ‚ãÖ ] denotes the relevant intracellular concentration (mmol L -1 ); and ùëò ùëì,ùëó ( min -1 ) is the kinetic rate constant of reaction ùëó .

In (43)-(44), the NSD concentration inside the Golgi apparatus, [ NSD ùëß ] , is assumed to equal 20 times of of the corresponding cytosolic concentration, [ NSD ùëñ ] , computed from the NSD synthesis model [21]. The nucleotide concentration inside the Golgi apparatus, [ Nuc ùëõ ] , is taken to be saturating and is therefore fixed at the constant values reported in Table S1 [21].

Thecatalytic rate constant ùëò ùëì,ùëó follows the pH-dependent expression [45]:

<!-- formula-not-decoded -->

with the intra-Golgi pH estimated from the ammonia-based buffer relation

<!-- formula-not-decoded -->

where ùëò max ùëì,ùëó ( min -1 ) is the maximal kinetic rate, pH golgi opt is the optimal pH for enzyme ùëó , ùúîùëì,ùëó is a dimensionless width parameter, ùëùùêæ golgi ùê¥ is the apparent acid dissociation parameter, and ùëÅ golgi ùê¥ is a fitted buffer capacity.

Each enzyme concentration along the Golgi cisternae follows a Gaussian (bell-shaped) profile:

<!-- formula-not-decoded -->

where ùê∏ùëó, max (mmolL -1 ) is the peak concentration, ùëß ùëó, max is the axial position of this peak (scaled 0 -1 from cis to trans), and ùúé ùëó is the standard deviation that characterizes enzyme dispersion along the Golgi stack.

## 3. Control problem

The goal is to maximize the harvest titer of the target glycoform while satisfying all process and product constraints. A widely used performance metric is the galactosylation index (GI) at harvest,

Wefocusoneconomiccontrol of a fed-batch bioreactorthe mode most employed in industry because of its operational flexibility. The culture runs for a total duration ùëá . Nutrient supplements are added for a short period Œî ùë° feed once every sampling interval ùúè = ùëá ‚àï ùëÅ , where ùëÅ is the number of control intervals. No harvest stream is withdrawn until the batch ends at ùë° = ùëá .

<!-- formula-not-decoded -->

where the bracketed terms denote the extracellular concentrations of the indicated glycoforms. Manipulated variables ùë¢ (feed flow rates) and state variables ùë• (cell density, metabolite concentrations, glycoform percentages, etc.) are bounded by

<!-- formula-not-decoded -->

The manipulated inputs are the feed stream flow rates ùêπ ùë† for ùë† = 1 , ‚Ä¶ , ùëÜ . Up to three feeds can be employedsupplement medium, galactose solution, and uridine solutionso 0 ‚â§ ùëÜ ‚â§ 3 . The composition of each stream is listed in Table 1.

In an ideal scenario-perfect model, exact initial state, and no disturbances-the economic optimization of the fed-batch process reduces to an offline dynamic optimization (DO-offline),

Compositions of the feed streams (all concentrations in

Table 1 mmolL -1 ).

| Metabolite   |   Medium |   Gal solution |   Urd solution |
|--------------|----------|----------------|----------------|
| Glc          |   144.37 |              0 |              0 |
| Gln          |     0    |              0 |              0 |
| Lac          |     0    |              0 |              0 |
| Amm          |     0.06 |              0 |              0 |
| Glu          |    12.19 |              0 |              0 |
| Asn          |    26.99 |              0 |              0 |
| Asp          |    51.95 |              0 |              0 |
| Gal          |     0    |           3600 |              0 |
| Urd          |     0    |              0 |           2000 |

## (DO-offline)

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where glyco ( ùë¢, ùëù ) denotes the implicit PDAE model (1)-(47) parameterized by ùëù (the glycosylation model parameters); ùë• 0 represents the initial values of the state variables; ùë• path and ùë• terminal are path and terminal constraint bounds; and the input bounds ùë¢ lb ( ùë° ) and ùë¢ ub ( ùë° ) are time-dependent, allowing, for example, zero flow rates during hold periods.

To evaluate the closed-loop performance of ANMPC, we inject measurement noise into simulated data using the standard deviations (stds) computed from the dataset of Ref. [21]. Two measurement scenarios are considered:

In practice, the ideal assumptions rarely hold. We address model-plant mismatch by embedding parameter adaptation within the NMPC framework (ANMPC), while the remaining assumptions hold given careful pre-start measurements and carefully controlled bolus feeding.

- (1) Full measurement -all state variables are available;
- (2) Industry-realistic measurement - NSDs and certain metabolites (Asn, Asp) and glycoforms (HM, FA1G1, SIA) remain unobserved, reflecting current analytical limitations.

The potential measurement variables and their standard deviations are summarized in Tables 2-4.

## 4. Adaptive NMPC (ANMPC) framework

The adaptive NMPC loop iteratively updates model parameters, state estimates and future control actions using online measurements. Algorithm 1 summarizes the procedure:

Table 2 Measurement variables and standard deviations in the cell culture model.

| Variables                                                                                                           | Std                                     | Variables                                                                                                         | Std                            |
|---------------------------------------------------------------------------------------------------------------------|-----------------------------------------|-------------------------------------------------------------------------------------------------------------------|--------------------------------|
| ùëâ (L) ùëã (cellsmL - 1 ) ùëã v (cellsmL - 1 ) ùëê Glc (mmolL - 1 ) ùëê Gln (mmolL - 1 ) ùëê Lac (mmolL - 1 ) ùëê Amm (mmolL - 1 | 0.001 494.66 494.66 1.45 0.11 0.48 0.17 | ùëê Glu (mmolL - 1 ) ùëê Gal (mmolL - 1 ) ùëê Urd (mmolL - 1 ) ùëê Asn (mmolL - 1 ) ùëê Asp (mmolL - 1 ) ùëê mAb (mmolL - 1 ) | 0.22 3.80 0.87 0.22 0.84 11.05 |

Table 3 Measurement variables and standard deviations in the NSD model (all concentrations/Stds are in mmol L -1 ).

| Variables    |   Std | Variables    | Std   |
|--------------|-------|--------------|-------|
| ùëê UDP-GlcNAc | 0.25  | ùëê UDP-Glc    | 0.22  |
| ùëê GDP-Fuc    | 0.004 | ùëê GDP-Man    | 0.003 |
| ùëê UDP-Gal    | 0.18  | ùëê UDP-GalNAc | 0.03  |
| ùëê CMP-Neu5Ac | 0.005 |              |       |

Table 4 Measurement variables and standard deviations in the Golgi model (all variables/Stds are in %).

| Variables                                                          | Std                      | Variables                                      | Std                 |
|--------------------------------------------------------------------|--------------------------|------------------------------------------------|---------------------|
| ùë¶ extra HM ùë¶ extra FA1G1 ùë¶ extra FA2G0 ùë¶ extra FA2G1 ùë¶ extra FA2G2 | 0.64 0.15 1.05 0.99 0.82 | ùë¶ extra SIA ùë¶ extra G0 ùë¶ extra G2 ùë¶ extra Man5 | 0.12 0.42 0.49 0.90 |

## Algorithm 1 (ANMPC algorithm).

## Initialization

Set counter ùëò = 0 , current time ùë° = 0 . Specify: total batch duration ùëá ; number of control intervals ùëÅ and length ùúè = ùëá ‚àï ùëÅ ; feed window Œî ùë° feed ; preparation time Œî ùë° prep . Times: ùë° ùëó = ùëó ùúè ( ùëó = 0 , ‚Ä¶ , ùëÅ ) , ùë° end ùëó = ùëó ùúè +Œî ùë° feed ( ùëó = 0 , ‚Ä¶ , ùëÅ -1) , ùë° sample ùëó = ùëó ùúè -Œî ùë° prep ( ùëó = 1 , ‚Ä¶ , ùëÅ ) . Initialize parameters ÃÇ ùëù (0) .

## Step 1: Parameter estimation

If ùëò ‚â• 1 and the ùëò th sample has been analyzed, update ÃÇ ùëù ( ùëò ) using all the available measurements { ùë¶ ( ùëó )} ùëò ùëó =1 ; otherwise skip to Step 3.

## Step 2: State estimation

Simulate the process model from ùë° = 0 to ùë° ùëò with ùëù = ÃÇ ùëù ( ùëò ) and obtain the current state estimate ÃÇ ùë• ( ùëò ) .

## Step 3: Dynamic optimization

<!-- formula-not-decoded -->

Solve the dynamic optimization problem (soft-DOùëò ) over ùë° ùëò ‚â§ ùë° ‚â§ ùëá with parameters ÃÇ ùëù ( ùëò ) and initial condition ÃÇ ùë• ( ùëò ) , and generate the optimal control sequence

## Step 4: Bioreactor operation &amp; sampling

Implement ùë¢ ( ùëò ) over ùë° ùëò ‚â§ ùë° ‚â§ ùë° end ùëò , and acquire a new sample at ùë° sample ùëò +1 with the analysis results of ùë¶ ( ùëò +1) . If ùë° ùëò +1 &lt; ùëá , set ùëò ‚Üê ùëò +1 and return to Step 1; otherwise proceed to Step 5.

## Step 5: Harvest

Shut down the bioreactor and harvest the product.

Figure 4: Timeline of the ANMPC algorithm.

<!-- image -->

The timeline of the ANMPC algorithm is shown in Figure 4. The preparation time Œî ùë° prep in ANMPC must exceed the combined duration of analytics, parameter estimation, state estimation, and optimization to guarantee real-time feasibility. This relies on the efficient optimization algorithm introduced later. For the case studies considered here, the algorithm parameters are listed in Table 5.

Table 5 Parameters in the ANMPC algorithm for the glycosylation process control problem.

| Parameter    | Description                     | Value                                        |
|--------------|---------------------------------|----------------------------------------------|
| ùëá (h)        | Total culture time              | 288                                          |
| ùëâ 0 (L)      | Initial working volume          | 1.5                                          |
| Œî ùë° feed (h) | Feed window length              | 0.01                                         |
| Œî ùë° prep (h) | Preparation time                | 2 in Sections 5.2-5.3; 4 in Sections 5.4-5.5 |
| ùúè (h)        | Length of each control interval | 24                                           |
| ùëÅ (-)        | Number of control intervals     | 12                                           |

The next subsections detail the dynamic optimization, parameter estimation, and state estimation components of the ANMPC.

## 4.1. Dynamic optimization formulation

To generate the control actions at ùë° ùëò in Step 3 of ANMPC, the controller solves the finite-horizon optimization (DOùëò ):

## (DOùëò )

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

Relative to the offline problem (DO-offline), the model parameters ùëù are replaced by their current estimates ÃÇ ùëù ( ùëò ) in the problem (DOùëò ), the initial conditions are substituted by the latest state estimate ÃÇ ùë• ( ùëò ) , and the horizon is shortened to [ ùë° ùëò , ùëá ] because of the shrinking horizon in the fed-batch

Table 6

Constraint bounds, types, and penalty weights.

| Variable                    | Description                   | Constraint type   | Lower bound   | Upper bound   | Penalty weight   |
|-----------------------------|-------------------------------|-------------------|---------------|---------------|------------------|
| viability (%)               | Cell viability                | Terminal, soft    | 60            | -             | 10               |
| ùëå extra Man5 (%)            | Extracellular Man5 percentage | Terminal, soft    | -             | 5             | 100              |
| ùëâ (L)                       | Working volume                | Terminal, hard    | 0.75          | 2.25          | -                |
| ùêπ ùë† (Lh - 1 ) ùë† = 1 , 2 , 3 | Feed flow rate                | Input             | 0             | 100           | -                |

operation [6, 32]. It is expected that as data accumulate, ÃÇ ùëù ( ùëò ) and ÃÇ ùë• ( ùëò ) move closer to the ground-truth values, the optimization problem (DOùëò ) will yield progressively better predictions than the static offline optimization that uses ÃÇ ùëù (0) .

Because parameter uncertainty can cause previously computed inputs to be overly aggressive, DOùëò may become infeasible even when DO0 was feasible. To reduce infeasibility in the optimization, we employ a soft-constraint formulation [37],

## soft-DOùëò :

<!-- formula-not-decoded -->

## s.t. Eqs. (56)-(57)

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

Here the state constraints are partitioned into hard constraints, which must always be respected, and soft constraints, which may be violated at the cost of penalty weights ùúå ùë§ (path) and ùúå ùë£ (terminal). The variables ùë§ ( ùë° ) and ùë§ ( ùë° ) are slack variables for the soft path constraints, whereas ùë£ and ùë£ are slack variables for the soft terminal constraints. Problem ( soft-DOùëò ) is solved only if the original problem ( DOùëò ) is infeasible.

Table 6 summarizes the constrained variables along with their permissible ranges and associated penalty weights.

## 4.2. Parameter estimation formulation

The multiscale model contains ‚àº100 kinetic and transport parameters-far too many to calibrate accurately from the limited data available in most cases. Consequently, the parameters are adapted online using every measurement collected to date, i.e., Step 1 in ANMPC. Furthermore, the simulation with the updated parameters is used for state estimation, i.e., Step 2 in ANMPC.

We explore two windowing strategies for the online parameter estimation problem-expanding horizon estimation (EHE) and full horizon estimation (FHE). In the fed-batch process, the former is more natural as the horizon with available data becomes longer over time, so we are interested in the expanded horizon. In EHE, once the ùëò th sample at ùë° sample ùëò ( ùëò ‚â• 1 ) is available, we solve the problem

## EHEùëò :

<!-- formula-not-decoded -->

(

)

‚ä§

+

ÃÇ ùëù

(

ùëò

) -

ÃÇ ùëù

(0)

ùëÉ

ÃÇ ùëù

(

ùëò

) -

ÃÇ ùëù

(0)

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where ùë¶ ( ùëó ) and ÃÇ ùë¶ ( ùëó ) are the measured and predicted outputs, ùëâ ùúñ ( ùëó ) is the measurement-noise covariance, and ùëÉ penalizes deviation from the prior parameter vector ÃÇ ùëù (0) . When ùëÉ = ùëâ -1 ùëù (the prior covariance matrix), we obtain a maximum a posteriori (MAP) estimator (e.g., [10]); when ùëÉ = 0 , we get a maximum likelihood estimator (MLE) (e.g., [3]).

EHEmayoverfit early data and predict physically impossible trajectories (e.g., negative concentrations) in the later horizon, jeopardizing feasibility of the subsequent NMPC problem. To reduce overfitting, we instead fit the parameters over the entire horizon [0 , ùëá ] even though data exist only up to ùë° sample ùëò , i.e., full-horizon estimation (FHE). In this way, parameters causing infeasible simulation beyond the measurement window are automatically discarded when solving the parameter estimation problem iteratively. To further protect against unphysical states, upper and lower bounds on the states can be incorporated into the estimation problem according to domain knowledge, resulting in the constrained FHE estimator

## cons-FHEùëò :

<!-- formula-not-decoded -->

(

)

There are two points to mention for the implementation of the online estimator:

- (1) In the online parameter adaptation step, distinct estimators are applied to different submodels. Parameters in the cell culture submodel are updated with a MAP estimator ( ùëÉ = ùëâ -1 ùëù in Eq. (67) ) , whereas parameters in the NSD and Golgi submodels are fitted together by MLE ( ùëÉ = 0 in Eq. (67) ) . Alternative combinations were tested but proved inferior: applying MLE to the cell culture block led to severe overfitting in the early phase of the run, which in turn drove the simulation and subsequent optimization to diverge; conversely, employing MAP for the NSD and Golgi blocks introduced an overly strong prior that resulted in underfitting and degraded ANMPC performance. Fitting the NSD and Golgi models separately also produced underfitting and was therefore abandoned.
- (2) Because the parameters span several orders of magnitude, the optimization is performed in log-space for self-normalization; that is, we estimate ln ÃÇ ùëù ( ùëò ) rather than ÃÇ ùëù ( ùëò ) . Without this approach, parameter estimation often fails due to divergence in the sensitivityequation evaluations, where the Jacobian becomes highly ill-conditioned.

## 4.3. Solution of the optimization problems

To make the optimization tractable, we accelerate each model evaluation with the parallel QSS algorithm introduced in our earlier work, which reduces overall simulation/optimization time by two orders of magnitude [26]. The idea relies on a clear time-scale separation: the Golgi reactions equilibrate much faster than the outer-layer dynamics. Long before extracellular conditions change appreciably, the Golgi has already reached a local steady state. Under the steady state, the Golgi model becomes a DAE (along the length of the Golgi apparatus) instead of the original PDAE, simplifying the computation significantly. The complete QSS algorithm is described briefly as Algorithm 2.

The above dynamic optimization and parameter estimation both require repeated solutions of optimization problems subject to the multiscale glycosylation model. We adopt the control vector parameterization (CVP) method for the optimizations [22, 44], which is more reliable than simultaneous methods for strongly nonlinear dynamics-constrained problems [13]. In CVP, however, the large PDAE system described in Section 2 and its sensitivity equations must be solved tens or hundreds of times with an implicit timestepping scheme, which dominates the computational cost.

## Algorithm 2 (QSS algorithm).

Initialization . Choose a set of time points ÓâÄ = { ùë° ùë† } ùëÅ QSS ùë† =1 .

Step 2: Get ùëå intra ùëñ . For every ùë° ùë† , solve the steady-state Golgi DAE with env( ùë° ùë† ) as inputs, yielding intracellular glycoform fractions ùëå intra ùëñ ( ùë° ùë† ) . The ùëÅ QSS Golgi simulations are fully multithread parallelizable.

Step 1: Get env . Integrate the cell-culture model (omitting glycoprotein balances) and the NSD model to obtain the environmental states env( ùë° ùë† ) at each ùë° ùë† .

Step 3: Get ùëå extra ùëñ . Reintegrate the complete cell culture model to produce the extracellular glycoform trajectories ùëå extra ùëñ ( ùë° ùë† ) , where all the ùëå intra ùëñ ( ùë° ùë† ) in the model are treated as time-varying parameters and are obtained from Step 2.

Following Ref. [26], we achieve satisfactory accuracy for ùëå extra ùëñ when the QSS time grid ÓâÄ includes all event instants (feed start/stop, sampling, etc.) and is augmented with 100 uniformly spaced points over [0 , ùëá ] .

## 5. Case study

All computations are performed on a Windows 11 machine with a 12th-Generation Intel Core i7-12700H CPU (14 cores/20 threads, 2.30 GHz) and 16 GB RAM. Python 3.9 [43] and CasADi 3.6.5 [1] were used as the computation platform. The nonlinear programs (NLPs) arising from the CVP formulation are solved with PySQP, an in-house sequential quadratic programming (SQP) solver based on the I-SQP algorithm [25] with a watchdog-technique enhancement. The DAE systems in the QSS algorithm are integrated with the IDAS solver [8, 12] via CasADi, using 15 threads for parallel computation. Under these settings, the total runtime per control move (parameter estimation + state estimation + dynamic optimization) is less than 2 h in all case studies. In Sections 5.2 and 5.3, we assume rapid analytics and set the preparation time Œî ùë° prep = 2h ; in Sections 5.4 and 5.5, we use a more realistic Œî ùë° prep = 4h to account for assay time.

To evaluate the proposed ANMPC framework, we first calibrate the multiscale model to the dataset of Ref. [21], obtaining a MAP parameter vector ln ùëù ‚àó and its covariance ùëâ ln( ùëù ) . We treat ln ùëù ‚àó as the ground truth. Five distinct initial guesses ln ÃÇ ùëù (0) are then generated on the boundary of the 50% confidence ellipsoid defined by ùëâ ln( ùëù ) so that the conclusions based on the case studies are more reliable. These ln ÃÇ ùëù (0) vectors, together with ùëâ ln( ùëù ) , serve as the prior mean and covariance in the online estimation step. The groundtruth and initial parameter values are listed in Tables S2-S4, while the covariances for submodels are provided in the Excel file in Supplementary 2. For convenience, we denote the five initial parameter sets as Init\_0 , Init\_1 , Init\_2 , Init\_3 , and Init\_4 .

## 5.1. Open-loop optimization study

Because supplement medium is routinely fed whereas Gal and Urd are not, we first solve the open-loop optimization with different combinations of feed streams to study the

influence of Gal and Urd feeding. Here, the ground-truth parameters are used, and the optimization results are shown in Table 7.

Table 7 Optimized fed-batch performance with different feeds.

| Feed streams       |   Harvest volume (L) |   GI (mg L -1 ) |
|--------------------|----------------------|-----------------|
| None (batch)       |                 1.38 |          174.27 |
| Medium only        |                 2.18 |          247.28 |
| Medium + Gal       |                 2.23 |          404    |
| Medium + Urd       |                 2.23 |          405.25 |
| Medium + Gal + Urd |                 2.23 |          405.25 |

Adding only the supplement medium raises the galactosylation index (GI) by about 42% relative to the batch baseline. Supplementing the medium with either galactose or uridine produces a much larger benefit: the optimal GI is roughly 64% higher than with medium alone (and more than double the batch value). Adding uridine gives a slightly ( 0 . 3% ) higher GI than adding galactose. Introducing both galactose and uridine simultaneously provides no further gain, because the optimizer drives the galactose feed rate to zero whenever uridine is available. Thus, only one of the two supplemental streams is required; the decision between galactose and uridine should be based on robustness and operational practicality rather than peak GI alone.

Although supplementing the reactor with Urd yields a slightly higher GI than Gal, the process is much more sensitive to Urd dosing. We quantify the response to the initial Urd pulse volume ùëâ Urd by varying its value from 0 mL to 20 mL while holding the medium feed fixed. Figure 6 shows a sharp optimum at 0.014 mL, giving a harvest GI of 405 mg L -1 . Increasing the pulse to just 1 mL lowers GI to about 350 mg L -1 -a 13.6% drop-demonstrating that small deviations from the optimum can markedly degrade product quality and, therefore, robustness in the presence of

Figure 5 compares the optimal time courses obtained with different feed strategies. Figure 5a confirms the ranking in Table 7: every feeding strategy raises the harvest GI relative to the batch baseline, but the trajectories diverge markedly once galactose or uridine is introduced. When only supplement medium is added, the improvement in extracellular GI stems almost entirely from biomass growth-the viable cell density roughly doubles (Figure 5b)-even though the intracellular GI falls slightly (Figure 5d). Adding galactose or uridine in addition to the medium changes the picture: both supplements elevate the intracellular GI by roughly 20% (Figure 5d), on top of the higher viable cell density achieved with medium feeding, yielding the pronounced increase in extracellular GI shown in Figure 5a. The increase in intracellular GI is driven by an elevated UDPGal concentration, a key donor for galactosylation (Figure 5c). Once the UDPGal concentration is sufficiently high, however, the incremental benefit plateaus; this is evident from the close overlap of the green dash-dot and red dotted curves in Figure 5d, which correspond to Gal and Urd supplement scenarios, respectively.

Figure 5: Optimal trajectories of crucial variables when using different feed streams.

<!-- image -->

Figure 6: a) Sensitivity of harvest GI to the Urd feed volume on day 1, b) viable cell density trajectories for three pulse feed volumes, and c) intracellular GI trajectories for the same three different three pulse feed volumes.

<!-- image -->

model-plant mismatch or input disturbances. Figures 6bc further indicate that the GI loss is driven primarily by reduced viable cell density throughout the run and by lower intracellular GI during the high cell density phase.

Given the above analysis, the subsequent closed-loop studies employ medium + Gal as the manipulated streams and omit Urd.

In contrast, the harvest GI is far less sensitive to the galactose pulse volume ùëâ Gal near its optimum-15 mL on day 3 and 58 mL on day 4 , with no Gal on the other days. Figures 7a-c illustrate this robustness. When ùëâ Gal is above 10 mL on each of the first four days (Figure 7a), the harvest GI changes only slowly, and declines rapidly only when ùëâ Gal falls below 5 mL. Moreover, varying the Gal dose on a single day while keeping the other days at their optimal values (Figs. 7bc) produces only minor changes in GI. These results confirm that galactose feeding is a potent yet forgiving lever for glycosylation control, whereas uridine requires nearperfect tuning to realize its modest advantage.

Figure 7: Sensitivity of harvest GI to the Gal feed volume, a) vary cap V sub Gal simultaneously on days 1-4, b) vary cap V sub Gal on day 3, c) vary cap V sub Gal on day 4.

<!-- image -->

## 5.2. Open-loop optimization vs. State NMPC vs. ANMPC

To benchmark the ANMPC scheme, we compared five controllers, all initiated from the same inaccurate parameter vector:

- (1) Groundtruth - dynamic optimization with the groundtruth parameters ùëù ‚àó .
- (2) Cell culture - dynamic optimization with the objective of maximizing titer, which is a common scenario when there is only the cell culture model. Here, Ground-truth parameters ùëù ‚àó are used.
- (3) Open loop - dynamic optimization with the inaccurate parameters ÃÇ ùëù (0) .
- (4) State NMPC - including feedback on measured states and using fixed parameters ÃÇ ùëù (0) .
- (5) ANMPC - adjust parameters online with the measured states.

To compare with state NMPC more easily, we assume full state measurement in this section, while the more realistic measurement scheme will be considered in Sections 5.4 and 5.5.

Because model-plant mismatch may drive viability at harvest below its 60% limit and thereby activate the softconstraints optimization, we evaluate each controller with a penalized merit function

<!-- formula-not-decoded -->

FromTable 8, optimizing the cell culture model only will cause extremely low GI (50 times smaller than the groundtruth solution) because the operating condition of maximizing titer leads to very little FA2G2 and FA2G1 synthesized in the Golgi apparatus (less than 1% for most of the culture time). Open-loop optimization performs second worst for most initializations, producing merits roughly one-half of the ground-truth optima. ANMPC shows a substantial gain using the same penalty weights ùúå ùë£ as in the soft-constrained formulation (soft-DOùëò ; see Table 5). Table 8 reports the merits across the five parameter scenarios.

Table 8 Merits under different control algorithms.

|              | Init_0   | Init_1   | Init_2   | Init_3   | Init_4   |
|--------------|----------|----------|----------|----------|----------|
| Open loop    | 185.88   | 272.64   | 231.17   | 219.86   | 274.78   |
| State NMPC   | 276.08   | - a      | - a      | 202.26   | 367.22   |
| ANMPC        | 216.82   | 362.89   | 220.38   | 218.30   | 380.92   |
| Cell culture |          |          | 8.70     |          |          |
| Ground truth |          |          | 404.00   |          |          |

- a State NMPC terminated prematurely for Init\_1 and Init\_2 .

Figure 8: Gal feed rate profiles under ANMPC for different initial parameter sets. The feed window duration is 0.01 h.

<!-- image -->

(over 30% ) for Init\_1 and Init\_4 , but offers only marginal or no improvement over open-loop optimization for the other runs. State NMPC terminates prematurely for Init\_1 and Init\_2 due to infeasible simulations during optimization. Overall, none of the controllers consistently achieve satisfactory performance.

A closer look at the ANMPC operation strategies shows that the low-merit cases ( Init\_0 , Init\_2 , Init\_3 ) never feed Gal, whereas the high-merit cases ( Init\_1 , Init\_4 ) apply appropriate Gal dosing (Figure 8). Consistent with Table 7, omitting Gal caps the ground-truth optimal GI at just 247 mg L -1 . This behavior occurs because the inaccurate initial parameters undervalue Gal's positive impact on galactosylation, so the optimizer chooses not to add Gal. Without Gal feeding, the Gal-related parameters are not excited and therefore cannot be updated, which masks the potential advantage of ANMPC.

## 5.3. Enforcing a minimum galactose dose

The previous section showed that, when ANMPC selects zero galactose feeding, the Gal-related parameters cannot be updated and performance stalls. To force at least minimal excitation, we impose a lower bound of 1 mL on the Gal feed volume during day 1-a negligible volume compared with over 1 L working volume. Table 9 compares the resulting merits for the various control strategies under this specification.

Table 9 Merits after imposing a 1 mL Gal feeding lower bound on day

1.

|              | Init_0   | Init_1   | Init_2   | Init_3   | Init_4   |
|--------------|----------|----------|----------|----------|----------|
| Open loop    | 183.36   | 324.88   | 197.27   | 166.23   | 201.67   |
| State NMPC   | 224.55   | - a      | - a      | 197.11   | 378.11   |
| ANMPC        | 380.37   | 398.29   | 389.53   | 386.79   | 387.06   |
| Ground truth |          |          | 404.00   |          |          |

- a State NMPC terminated prematurely for Init\_1 and Init\_2 .

Comparing Table 8 (no Gal feed lower bound) with Table 9 (1 mL lower bound on day 1), the open-loop and stateNMPC controllers show almost no progress: their merits remain roughly half of the 404 benchmark, and state NMPC still fails to converge for two of the five initializations. By contrast, ANMPC improves markedly once the small day1 galactose dose is enforced. Its merits lie within 6% of the ground-truth optimum for every initialization and exhibit little scatter, indicating substantially greater robustness. Relative to ANMPC without a Gal lower bound, the merit increases by more than 75% for Init\_0 , Init\_2 , and Init\_3 . Compared with open-loop optimization and state NMPC under the same Gal feed constraint, ANMPC delivers gains of up to 130% and 96% ( Init\_3 ), respectively. These results confirm that introducing even a minimal Gal feed early in the cell culture provides sufficient excitation to update Galrelated parameters and enables the adaptive controller to approach its full potential.

The contrasting control performances can be traced to how each algorithm handles model-plant mismatch, as illustrated by the evolution of the GI prediction errors at the harvest time in Figure 10. At the start of the run (day 0) the three schemes-open-loop optimization, state NMPC, and ANMPC-share the same parameter set, so their GI prediction errors are identical, about 200 mg L -1 . Thereafter, the open-loop error remains unchanged because no feedback

Figure 9 illustrates the input profiles and trajectories for Init\_0 alongside the ground-truth policy. The groundtruth optimization splits the medium addition into two pulses-one at the start of culture and a second after nine days (Figure 9a). This staged strategy moderates the latephase viability drop and satisfies the terminal viability limit (Figure 9c). In contrast, the other controllers deliver nearly the entire medium volume at the outset, pushing the broth quickly to the reactor's upper volume limit and leaving little capacity for a compensatory feed later; the resulting nutrient depletion leads the NMPC variants to violate the viability constraint. The second key difference appears in Figure 9b: substantial Gal supplementation occurs only in the groundtruth and ANMPC policies, yielding a markedly higher GI in Figure 9d. Like open-loop and state NMPC, ANMPC omits Gal during the first three days due to initial model mismatch. Once the parameter estimates improve, however, ANMPC initiates Gal feeding; from that point forward, its GI trajectory closely tracks the ground-truth benchmark and remains well above the curves from the other two controllers.

Figure 9: Control inputs and key state trajectories for the control schemes starting from Init\_0 and the ground-truth optimization: (a) medium feed flow rate, (b) Gal feed flow rate, (c) cell viability, and (d) GI.

<!-- image -->

Figure 10: Evolution of the GI prediction error at harvest time when starting from Init\_0.

<!-- image -->

is used to refine the model. In both state NMPC and ANMPC, the error decreases as new measurements arrive, but ANMPC's errors are consistently smaller than those of state NMPC. Within two days, the GI error under ANMPC drops below 50 mg L -1 (except on days 3-5), whereas state NMPC does not reach this level until about day nine. The rapid improvement in ANMPC stems from its online parameter adaptation, whereas the slower drift in state NMPC reflects only the shrinking prediction horizon and the availability of full-state measurements, not improved model accuracy. By the time state NMPC finally achieves a similar error magnitude, only three days remain to influence the harvest GI, leaving ANMPC with the practical advantage.

## 5.4. ANMPC with fewer measurements and longer preparation time

Here we evaluate ANMPC under more realistic conditions: (1) partial measurement availability-no readings for

Table 10 ANMPC under different measurements and preparation time.

|                            |   Init_0 |   Init_1 |   Init_2 |   Init_3 |   Init_4 |    Avg |
|----------------------------|----------|----------|----------|----------|----------|--------|
| Full a + Œî ùë° prep = 2 h    |   380.37 |   398.29 |   389.53 |   386.79 |   387.06 | 388.41 |
| Partial b + Œî ùë° prep = 2 h |   387.81 |   395.6  |   392.24 |   388.52 |   384.52 | 389.74 |
| Partial b + Œî ùë° prep = 4 h |   386.18 |   395.25 |   387.89 |   386.62 |   379.4  | 387.07 |

- a 'Full' = all variables measured.
- b 'Partial' = excludes extracellular Asn and Asp, extracellular glycan fractions (HM, FA1G1, SIA), and all intracellular NSD concentrations.

extracellular Asn and Asp, the extracellular glycan fractions HM, FA1G1, and SIA, or any intracellular NSD concentrations; (2) a longer preparation time of 4 h to account for computation and assay turnaround. The results are summarized in Table 10.

Table 10 shows that, for a given initial parameter set, the penalized merit varies by less than 2% across different measurement schemes and preparation times. In particular, using partial measurements and a 4 h preparation window does not necessarily degrade performance relative to the full measurements and 2 h baseline. Therefore, a leaner measurement set and a relaxed preparation window can be adopted as a more economical choice without sacrificing control quality.

## 6. Conclusions

Sensitivity studies show that both Gal and Urd can raise GI by about 64% relative to feeding medium alone to the bioreactor, but Urd is overly dosage-sensitive for control. Across case studies with multiple initial parameter sets, ANMPC delivers up to 130% and 96% higher penalized merit than open-loop optimization and state NMPC, respectively-provided a small day-1 Gal lower bound is imposed to excite Gal-related dynamics and enable adaptation. Moreover, using fewer measurements and a longer preparation time (4 h) did not materially degrade ANMPC performance, supporting practical deployability.

We applied an ANMPC framework to regulate the Nglycosylation in a fed-batch mAb bioreactor. The controller uses a high-fidelity multiscale PDAE model that links extracellular operating conditions to intracellular Golgi reactions to predict both mAb productivity and glycan profiles. To mitigate model-plant mismatch, parameters are updated online as new measurements arrive, after which a shrinking-horizon optimization recomputes the inputs. When the nominal dynamic optimization becomes infeasible, a soft-constraint formulation preserves solvability. To prevent unphysical predictions (e.g., negative concentrations), parameter estimation is performed over the full fedbatch horizon with state bounds. Computationally, parameter estimation and dynamic optimization yield large-scale, model-constrained problems that are challenging to solve. We therefore employ the control-vector parameterization (CVP) method for reliable convergence and accelerate embedded simulations via a parallel QSS algorithm.

Future work will explore stochastic ANMPC (e.g., chanceconstrained MPC) to balance constraint satisfaction and performance under uncertainty, and experimental validation of the proposed strategies.

## Acknowledgments

This work was supported by a Project Award Agreement from the National Institute for Innovation in Manufacturing Biopharmaceuticals (NIIMBL), with financial assistance from the U.S. Department of Commerce, National Institute of Standards and Technology (NIST), awards 70NANB17H002 and 70NANB20H037. We thank Professor Cleo Kontoravdi for generously providing the experimental data reported in her publication.

## Code availability

Code will be made publicly available upon acceptance. A reviewer link can be provided to editors on request.

## References

- [2] Batra, J., Rathore, A.S., 2016. Glycosylation of monoclonal antibody products: Current status and future prospects. Biotechnology Progress 32, 1091-1102. doi: 10.1002/btpr.2366 .
- [1] Andersson, J.A.E., Gillis, J., Horn, G., Rawlings, J.B., Diehl, M., 2019. CasADi: A software framework for nonlinear optimization and optimal control. Mathematical Programming Computation 11, 1-36. doi: 10.1007/s12532-018-0139-4 .
- [3] Beck, J.V., Arnold, K.J., 1977. Parameter Estimation in Engineering and Science. Wiley.
- [5] Dewasme, L., Fernandes, S., Amribt, Z., Santos, L.O., Bogaerts, P., Vande Wouwer, A., 2015. State estimation and predictive control of fed-batch cultures of hybridoma cells. Journal of Process Control 30, 50-57. doi: 10.1016/j.jprocont.2014.12.006 .
- [4] Dan, A., Liu, B., Patil, U., Manuraj, B.N.M., Gandhi, R., Buchel, J., Chundawat, S.P.S., Guo, W., Ramachandran, R., 2025. Machine learning model-based design and model predictive control of a bioreactor for the improved production of mammalian cell-based biotherapeutics. Control Engineering Practice 156, 106198. doi: 10.1016/ j.conengprac.2024.106198 .
- [6] Eaton, J.W., Rawlings, J.B., 1990. Feedback control of chemical processes using on-line optimization techniques. Computers &amp; Chemical Engineering 14, 469-479. doi: 10.1016/0098-1354(90)87021-G .
- [8] Gardner, D.J., Reynolds, D.R., Woodward, C.S., Balos, C.J., 2022. Enabling new flexibility in the SUNDIALS suite of nonlinear and
- [7] Federici, M., Lubiniecki, A., Manikwar, P., Volkin, D.B., 2013. Analytical lessons learned from selected therapeutic protein drug comparability studies. Biologicals 41, 131-147. doi: 10.1016/j. biologicals.2012.10.001 .

- differential/algebraic equation solvers. ACM Transactions on Mathematical Software 48, 31. doi: 10.1145/3539801 .
- [10] Gunawan, R., Jung, M.Y.L., Seebauer, E.G., Braatz, R.D., 2003. Maximum a posteriori estimation of transient enhanced diffusion energetics. AIChE Journal 49, 2114-2123. doi: 10.1002/aic.690490819 .
- [9] Goetze, A.M., Liu, Y.D., Zhang, Z., Shah, B., Lee, E., Bondarenko, P.V., Flynn, G.C., 2011. High-mannose glycans on the Fc region of therapeutic IgG antibodies increase serum clearance in humans. Glycobiology 21, 949-959. doi: 10.1093/glycob/cwr027 .
- [11] Hajizadeh, I., Rashid, M., Sevil, M., Brandt, R., Samadi, S., Hobbs, N., Cinar, A., 2018. Adaptive model predictive control for nonlinearity in biomedical applications, in: 6th IFAC Conference on Nonlinear Model Predictive Control (NMPC 2018), pp. 368-373. doi: 10.1016/j.ifacol.2018.11.061 .
- [13] Hong, W., Wang, S., Li, P., Wozny, G., Biegler, L.T., 2006. A quasisequential approach to large-scale dynamic optimization problems. AIChE Journal 52, 255-268. doi: 10.1002/aic.10625 .
- [12] Hindmarsh, A.C., Brown, P.N., Grant, K.E., Lee, S.L., Serban, R., Shumaker, D.E., Woodward, C.S., 2005. SUNDIALS: Suite of nonlinear and differential/algebraic equation solvers. ACM Transactions on Mathematical Software 31, 363-396. doi: 10.1145/1089014. 1089020 .
- [14] Jabarivelisdeh, B., Carius, L., Findeisen, R., Waldherr, S., 2020. Adaptive predictive control of bioprocesses with constraint-based modeling and estimation. Computers &amp; Chemical Engineering 135, 106744. doi: 10.1016/j.compchemeng.2020.106744 .
- [16] Jefferis, R., 2009. Glycosylation as a strategy to improve antibodybased therapeutics. Nature Reviews Drug Discovery 8, 226-234. doi: 10.1038/nrd2804 .
- [15] James, D.C., 2005. Control of recombinant monoclonal antibody effector functions by Fc N-glycan remodeling in vitro. Biotechnology Progress 21, 1644-1652. doi: 10.1002/btpr.50228 .
- [17] Kappatou, C.D., Ehsani, A., Niedenf√ºhr, S., Mhamdi, A., Schuppert, A., Mitsos, A., 2020. Quality-targeting dynamic optimization of monoclonal antibody production. Computers &amp; Chemical Engineering 142, 107004. doi: 10.1016/j.compchemeng.2020.107004 .
- [19] Kornfeld, R., Kornfeld, S., 1985. Assembly of asparagine-linked oligosaccharides. Annual Review of Biochemistry 54, 631-664. doi: 10.1146/annurev.bi.54.070185.003215 .
- [18] Kontoravdi, C., Pistikopoulos, E.N., Mantalaris, A., 2010. Systematic development of predictive mathematical models for animal cell cultures. Computers &amp; Chemical Engineering 34, 1192-1198. doi: 10.1016/j.compchemeng.2010.03.012 .
- [20] Kotidis, P., 2021. Enhanced Understanding of Protein Glycosylation in CHO Cells Through Computational Tools and Experimentation. Ph.D. thesis. Imperial College London. doi: 10.25560/100281 .
- [22] Kraft, D., 1985. On converting optimal control problems into nonlinear programming problems, in: Schittkowski, K. (Ed.), Computational Mathematical Programming. Springer Berlin Heidelberg, pp. 261280.
- [21] Kotidis, P., Jedrzejewski, P.M., Sou, S.N., Sellick, C., Polizzi, K., Jimenez del Val, I., Kontoravdi, C., 2019. Model-based optimization of antibody galactosylation in cho cell culture. Biotechnology and Bioengineering 116, 1612-1626. doi: 10.1002/bit.26960 .
- [23] Lu, F., Toh, P.C., Burnett, I., Li, F., Hudson, T., Amanullah, A., Li, J., 2013. Automated dynamic fed-batch process and media optimization for high productivity cell culture process development. Biotechnology and Bioengineering 110, 191-205. doi: 10.1002/bit.24602 .
- [25] Ma, Y., Gao, X., Liu, C., Li, J., 2024. Improved sqp and slsqp algorithms for feasible path-based process optimisation. Computers &amp; Chemical Engineering 188, 108751. doi: 10.1016/j.compchemeng. 2024.108751 .
- [24] Luo, Y., Kurian, V., Song, L., Wells, E.A., Robinson, A.S., Ogunnaike, B.A., 2023. Model-based control of titer and glycosylation in fed-batch mab production: Modeling and control system development. AIChE Journal 69, e18075. doi: 10.1002/aic.18075 .
- [26] Ma, Y., Guo, J., Maloney, A.J., Braatz, R.D., 2025. Quasi-steady-state approach for efficient multiscale simulation and optimization of mAb
- glycosylation in CHO cell culture. Chemical Engineering Science 318, 122162. doi: 10.1016/j.ces.2025.122162 .
- [28] Maloney, A.J., 2021. Case Studies in the Modeling and Control of Continuous Pharmaceutical Manufacturing Processes. Ph.D. thesis. Massachusetts Institute of Technology. URL: https://dspace.mit. edu/handle/1721.1/158315 .
- [27] Majewska, N.I., Tejada, M.L., Betenbaugh, M.J., Agarwal, N., 2020. N-glycosylation of IgG and IgG-like recombinant therapeutic proteins: Why is it important and how can we control it? Annual Review of Chemical and Biomolecular Engineering 11, 311-338. doi: 10.1146/annurev-chembioeng-102419-010001 .
- [29] Matsumiya, S., Yamaguchi, Y., Saito, J., Nagano, M., Sasakawa, H., Otaki, S., Satoh, M., Shitara, K., Kato, K., 2007. Structural comparison of fucosylated and nonfucosylated Fc fragments of human immunoglobulin G1. Journal of Molecular Biology 368, 767-779. doi: 10.1016/j.jmb.2007.02.034 .
- [31] Mullard, A., 2021. FDA approves 100th monoclonal antibody product. Nature Reviews Drug Discovery 20, 491-495. doi: 10.1038/ d41573-021-00079-7 .
- [30] McCamish, M., Woollett, G., 2013. The continuum of comparability extends to biosimilarity: How much is enough and what clinical data are necessary? Clinical Pharmacology &amp; Therapeutics 93, 315-317. doi: 10.1038/clpt.2013.17 .
- [32] Nagy, Z.K., Braatz, R.D., 2003. Robust nonlinear model predictive control of batch processes. AIChE Journal 49, 1776-1786. doi: 10. 1002/aic.690490715 .
- [34] Rawlings, J.B., Mayne, D.Q., Diehl, M., 2017. Model Predictive Control: Theory, Computation, and Design. volume 2. 2 ed., Nob Hill Publishing.
- [33] Pickhardt, R., 2000. Nonlinear modelling and adaptive predictive control of a solar power plant. Control Engineering Practice 8, 937947. doi: 10.1016/S0967-0661(00)00009-5 .
- [35] Sarna, S., Patel, N., Corbett, B., McCready, C., Mhaskar, P., 2023. Process-aware data-driven modelling and model predictive control of bioreactor for the production of monoclonal antibodies. The Canadian Journal of Chemical Engineering 101, 2677-2692. doi: 10.1002/cjce. 24752 .
- [37] Scokaert, P.O.M., Rawlings, J.B., 1999. Feasibility issues in linear model predictive control. AIChE Journal 45, 1649-1659. doi: 10. 1002/aic.690450805 .
- [36] Sauer, P.W., Burky, J.E., Wesson, M.C., Sternard, H.D., Qu, L., 2000. A high-yielding, generic fed-batch cell culture process for production of recombinant antibodies. Biotechnology and Bioengineering 67, 585-597. doi: 10.1002/(SICI)1097-0290(20000305)67:5&lt;585:: AID-BIT9&gt;3.0.CO;2-H .
- [38] Sha, S., Agarabi, C., Brorson, K., Lee, D.Y., Yoon, S., 2016. Nglycosylation design and control of therapeutic monoclonal antibodies. Trends in Biotechnology 34, 835-846. doi: 10.1016/j.tibtech. 2016.02.013 .
- [40] St. Amand, M.M., Radhakrishnan, D., Robinson, A.S., Ogunnaike, B.A., 2014a. Identification of manipulated variables for a glycosylation control strategy. Biotechnology and Bioengineering 111, 19571970. doi: 10.1002/bit.25251 .
- [39] Spahn, P.N., Hansen, A.H., Hansen, H.G., Arnsdorf, J., Kildegaard, H.F., Lewis, N.E., 2016. A Markov chain model for N-linked protein glycosylation - Towards a low-parameter tool for model-driven glycoengineering. Metabolic Engineering 33, 52-66. doi: 10.1016/j. ymben.2015.10.007 .
- [41] St. Amand, M.M., Tran, K., Radhakrishnan, D., Robinson, A.S., Ogunnaike, B.A., 2014b. Controllability analysis of protein glycosylation in CHO cells. PLOS ONE 9, e87973. doi: 10.1371/journal. pone.0087973 .
- [43] Van Rossum, G., Drake, F.L., 2009. Python 3 Reference Manual. CreateSpace.
- [42] Jimenez del Val, I., Nagy, J.M., Kontoravdi, C., 2011. A dynamic mathematical model for monoclonal antibody N-linked glycosylation and nucleotide sugar donor transport within a maturing Golgi apparatus. Biotechnology Progress 27, 1730-1743. doi: 10.1002/btpr.688 .

- [44] Vassiliadis, V.S., Sargent, R.W.H., Pantelides, C.C., 1994. Solution of a class of multistage dynamic optimization problems. 2. Problems with path constraints. Industrial &amp; Engineering Chemistry Research 33, 2123-2133. doi: 10.1021/ie00033a015 .
- [46] Walsh, G., Walsh, E., 2022. Biopharmaceutical benchmarks 2022. Nature Biotechnology 40, 1722-1760. doi: 10.1038/ s41587-022-01582-x .
- [45] Villiger, T.K., Scibona, E., Stettler, M., Broly, H., Morbidelli, M., Soos, M., 2016. Controlling the time evolution of mAb N-linked glycosylation-Part II: Model-based predictions. Biotechnology Progress 32, 1135-1148. doi: 10.1002/btpr.2315 .
- [47] Wong, D.C.F., Wong, K.T.K., Goh, L.T., Heng, C.K., Yap, M.G.S., 2005. Impact of dynamic online fed-batch strategies on metabolism, productivity and N-glycosylation quality in CHO cell cultures. Biotechnology and Bioengineering 89, 164-177. doi: 10.1002/bit. 20317 .
- [48] Zupke, C., Brady, L.J., Slade, P.G., Clark, P., Caspary, R.G., Livingston, B., Taylor, L., Bigham, K., Morris, A.E., Bailey, R.W., 2015. Real-time product attribute control to manufacture antibodies with defined N-linked glycan levels. Biotechnology Progress 31, 14331441. doi: 10.1002/btpr.2136 .

## Nonlinear Model Predictive Control of the Glycosylation Process of Monoclonal Antibody in CHO Cell Culture

Yingjie Ma, Jing Guo, Alexis B. Dubs, and Richard D. Braatz Massachusetts Institute of Technology, Cambridge, MA, 02139, USA

Table S1. The nucleotide concentration in the Golgi apparatus.

| Substrates         |   UDP |   GDP |   CMP |
|--------------------|-------|-------|-------|
| Concentration (mM) | 1.942 | 0.496 | 0.248 |

UDP: Uridine diphosphate, GDP: Guanosine diphosphate, CMP: Cytidine monophosphate.

Table S2. Ground-truth and initial cell culture model parameter values used in ANMPC.

| Variable    | Ground truth   | Init_0    | Init_1    | Init_2    | Init_3    | Init_4    |
|-------------|----------------|-----------|-----------|-----------|-----------|-----------|
| ùúá max       | - 2.73337      | - 2.55989 | - 2.80766 | - 2.79421 | - 2.85756 | - 2.61458 |
| ùúá death,max | - 4.19971      | - 5.46269 | - 3.05622 | - 4.73958 | - 4.0814  | - 4.3067  |
| ùêæ Glc       | 2.64191        | 6.39693   | - 1.96326 | - 1.96326 | - 1.96326 | 6.39693   |
| ùêæ Gal       | 2.903069       | 2.559989  | 2.856218  | 2.616629  | 2.919065  | 3.123035  |
| ùêæ Urd       | 1.94591        | 1.794221  | 2.103352  | 2.024514  | 2.011801  | 2.020159  |
| ùêæ Asn       | 0.963174       | 0.735057  | 1.213042  | 1.00316   | 1.046558  | 0.79888   |
| KI Amm      | 1.153732       | 0.988067  | 1.253167  | 1.185626  | 1.228392  | 1.050346  |
| KI Urd      | 3.715765       | 3.834552  | 3.546063  | 3.671895  | 3.732215  | 3.755688  |
| Kd Amm      | 2.65886        | 1.624842  | 3.543224  | 2.105782  | 3.017001  | 2.680639  |
| Kd Urd      | 3.327192       | 1.653394  | 4.983583  | 2.841407  | 3.344137  | 3.205529  |
| ùëå mAb ùëã     | 1.22083        | 1.246199  | 1.197321  | 1.190082  | 1.22175   | 1.238312  |
| ùëö mAb       | - 0.8916       | - 0.89174 | - 0.87547 | - 0.86846 | - 0.89231 | - 0.88482 |
| ùëå ùëã Glc     | 20.73322       | 20.69026  | 20.79923  | 20.75349  | 20.71485  | 20.72578  |
| ùëå ùëã Gln     | 22.25798       | 22.23582  | 22.29092  | 22.27095  | 22.27096  | 22.22578  |
| ùëå ùëã Lac     | 17.81554       | 17.75285  | 17.80856  | 17.83454  | 17.86724  | 17.80636  |
| ùëå ùëã Amm     | 21.58193       | 21.56213  | 21.58788  | 21.58079  | 21.57993  | 21.56905  |
| ùëå ùëã Glu     | 23.40429       | 23.38461  | 23.40029  | 23.40512  | 23.41202  | 23.39805  |

| ùëå ùëã Gal   | 18.74276   | 19.01825   | 18.75052   | 18.98836   | 18.72869   | 18.60622   |
|-----------|------------|------------|------------|------------|------------|------------|
| ùëå ùëã Urd   | 21.1995    | 21.28306   | 21.10624   | 21.21614   | 21.22185   | 21.24008   |
| ùëå ùëã Asn   | 20.4593    | 20.43981   | 20.46797   | 20.45803   | 20.45603   | 20.44601   |
| ùëö Glc     | - 24.0959  | - 24.1039  | - 24.0552  | - 24.0824  | - 24.1036  | - 24.0954  |
| ùëö Lac     | - 22.3999  | - 23.6157  | - 22.7132  | - 22.2846  | - 21.33    | - 22.1211  |
| ùêæ ùê∂ Gal   | 1.66203    | 1.637797   | 1.608433   | 1.646327   | 1.644553   | 1.741433   |
| ùëì Gal     | - 1.04982  | - 0.95896  | - 1.03361  | - 1.0096   | - 1.00322  | - 1.07413  |
| Lac max1  | 3.054001   | 3.041958   | 3.051802   | 3.062378   | 3.069329   | 3.047592   |
| Lac max2  | 2.772589   | 2.183389   | 2.626625   | 2.808422   | 3.273907   | 2.950022   |
| ùëå Gln/Amm | - 2.30259  | - 2.77241  | - 0.5385   | - 1.60263  | - 1.43506  | - 3.31356  |
| ùëå Asn/Asp | - 2.30259  | - 2.30262  | - 2.30257  | - 2.3026   | - 2.30258  | - 2.3026   |
| ùëå Amm/Urd | 0.693147   | 0.666049   | 0.744781   | 0.766537   | 0.751395   | 0.770753   |

Table S3. The initial NSD model parameter values used in ANMPC.

| Variable     | Ground truth   | Init_0    | Init_1    | Init_2    | Init_3    | Init_4    |
|--------------|----------------|-----------|-----------|-----------|-----------|-----------|
| ùëâ max,1      | 0.07851        | 2.221375  | - 2.3838  | - 2.20738 | - 2.3838  | 2.221375  |
| ùëâ max,2      | - 4.16763      | - 4.92916 | - 3.54846 | - 4.44524 | - 4.08572 | - 4.24891 |
| ùëâ max,2b     | 4.097821       | 6.388225  | 1.783055  | 1.783055  | 1.783055  | 6.388225  |
| ùëâ max,3      | - 2.937        | - 3.92764 | - 3.11023 | - 3.74464 | - 2.90283 | - 2.3039  |
| ùëâ max,4      | - 3.49024      | - 3.52893 | - 3.42217 | - 3.43708 | - 3.47991 | - 3.39183 |
| ùëâ max,5      | - 9.20488      | - 9.23247 | - 9.20829 | - 9.23741 | - 9.2117  | - 9.18441 |
| ùëâ max,6      | 1.606501       | - 0.66748 | 3.937691  | - 0.66748 | - 0.66748 | - 0.66748 |
| ùëâ max,7      | 1.572593       | 2.523005  | - 0.77653 | 3.828641  | 3.828641  | 3.828641  |
| ùëâ max,1 Urd  | - 1.92801      | - 1.92909 | - 1.97474 | - 1.95722 | - 1.83945 | - 1.91091 |
| ùëâ max,2 Urd  | - 2.86122      | - 2.90539 | - 2.85582 | - 2.74666 | - 2.8638  | - 2.82725 |
| ùëâ max,4 Urd  | - 4.38414      | - 4.41833 | - 4.24971 | - 4.42033 | - 4.56943 | - 4.41704 |
| ùëâ max,6 Urd  | 1.69449        | 3.35425   | 3.978316  | 3.978316  | 2.500113  | 3.978316  |
| ùëâ max,7 sink | 2.349945       | 4.695011  | 4.695011  | 4.695011  | 0.089841  | 0.089841  |
| ùëâ max,1      | 3.432078       | 0.935701  | 5.540871  | 5.540871  | 5.540871  | 0.935701  |

| ùëâ max,6 sink   | 2.0374    | 3.687171   | 4.290459   | 4.290459   | 2.84107   | 4.290459   |
|----------------|-----------|------------|------------|------------|-----------|------------|
| ùëâ max,6 Gal    | 3.638536  | 4.704453   | 5.661533   | 5.905233   | 4.216692  | 6.02519    |
| ùëì Gln          | - 3.79203 | - 6.21461  | - 1.60944  | - 1.60944  | - 1.60944 | - 6.21461  |
| ùêæ M1 Gln       | - 0.9875  | - 3.17009  | 1.435085   | 1.435085   | 1.435085  | - 3.17009  |
| ùêæ M1 sink      | - 3.21452 | - 3.08029  | - 3.08511  | - 3.1052   | - 2.9484  | - 3.33346  |
| KI 1 sink      | - 8.82695 | - 6.71713  | - 11.3223  | - 11.3223  | - 11.3223 | - 6.71713  |
| ùêæ M2 Glc       | 4.394494  | 2.055661   | 6.660831   | 2.98338    | 5.371626  | 3.593824   |
| ùêæ M2b UDPGal   | - 3.70909 | - 1.39433  | - 5.9995   | - 5.9995   | - 5.9995  | - 1.39433  |
| KI 2A          | - 13.8113 | - 16.0693  | - 11.4641  | - 11.4641  | - 11.4641 | - 16.0693  |
| KI 2B          | 4.522982  | 4.775267   | 4.136864   | 4.457755   | 4.455283  | 4.759863   |
| KI 2C          | - 4.31993 | - 6.62258  | - 2.01741  | - 2.01741  | - 2.01741 | - 6.62258  |
| KI 2D          | - 12.7805 | - 15.1398  | - 10.5346  | - 10.5346  | - 10.5346 | - 15.1398  |
| ùêæ M3 Glc       | 3.938518  | 5.046892   | 4.912108   | 4.837086   | 3.755154  | 3.480013   |
| ùêæ M4 UDPGlcNAc | 0.969506  | 0.917998   | 1.05351    | 1.021446   | 0.987863  | 1.081214   |
| ùêæ M5 UDPGlcNAc | - 3.59839 | - 3.92842  | - 3.536    | - 3.52125  | - 3.57602 | - 3.16815  |
| KI 5           | 6.907754  | 9.21034    | 4.60517    | 4.60517    | 4.60517   | 9.21034    |
| ùêæ M6 UDPGlc    | - 4.10657 | - 1.83258  | - 1.83258  | - 1.83258  | - 1.83258 | - 6.43775  |
| KI 6A          | - 16.0402 | - 13.7202  | - 18.3254  | - 13.7202  | - 13.7202 | - 13.7202  |
| KI 6B          | 1.519513  | 2.110467   | 0.642307   | 1.384974   | 1.361761  | 2.067355   |
| KI 6C          | - 12.2498 | - 14.5412  | - 14.5412  | - 14.5412  | - 14.5412 | - 14.5412  |
| ùêæ M6 sink      | - 2.05652 | - 3.95876  | - 4.34281  | - 4.34281  | - 2.85926 | - 4.34281  |
| KI 6 sink      | - 1.12932 | - 0.95854  | - 0.92372  | - 0.88972  | - 1.09845 | - 1.09435  |
| ùêæ M7 GDPMan    | - 0.05659 | 0.443242   | 0.478822   | 2.292535   | 2.292535  | - 0.14687  |
| KI 7           | - 4.10082 | - 6.41306  | - 1.80789  | - 3.59805  | - 6.41306 | - 6.41306  |
| ùêæ M7 sink      | 2.226197  | 4.486387   | 4.486387   | 4.486387   | - 0.11878 | - 0.11878  |
| ùêæ ùëÄ1 Urd       | 1.889027  | 1.761356   | 1.881457   | 1.926024   | 2.064203  | 1.914329   |
| ùêæ ùëÄ2 Urd       | 2.396853  | 2.264824   | 2.457587   | 2.80713    | 2.527026  | 2.424083   |
| ùêæ ùëÄ4 Urd       | 1.872129  | 1.865431   | 1.994391   | 1.842122   | 1.592921  | 1.897788   |
| ùêæ ùëÄ6           | - 0.84622 | - 2.69789  | - 3.96703  | - 4.12308  | - 1.69607 | - 4.35423  |

| ùêæ ùëÄ6 Gal        | - 0.44656   | - 2.78634   | - 4.09344   | - 4.70629   | - 0.93837   | - 4.81493   |
|-----------------|-------------|-------------|-------------|-------------|-------------|-------------|
| KI 6D           | - 4.67068   | - 4.45774   | - 4.593     | - 5.10185   | - 4.04721   | - 4.96951   |
| KI 6E           | 4.601409    | 5.180291    | 3.644233    | 4.405577    | 4.449866    | 5.122605    |
| KI 6F           | - 6.99762   | - 9.30355   | - 9.30355   | - 9.30355   | - 7.97132   | - 9.30355   |
| ùêæ TP,UDP-Glc    | - 0.0266    | 0.079036    | - 0.0399    | 0.032919    | 0.109992    | - 0.08821   |
| ùêæ TP,UDP-GlcNAc | 1.620836    | 3.726258    | 0.480274    | 0.723842    | - 0.6832    | 3.921973    |
| ùêæ TP,UDP-Gal    | 1.93832     | 0.326087    | 2.172851    | 1.172591    | 1.40261     | 0.978521    |
| ùêæ TP,UDP-GalNAc | 2.414956    | 2.359934    | 2.382138    | 2.287052    | 2.419422    | 2.505055    |
| ùêæ TP,GDP-Man    | - 2.06746   | - 0.2379    | - 1.94578   | - 1.09393   | - 1.81769   | - 2.66049   |
| ùêæ TP,GDP-Fuc    | - 2.30651   | - 4.60517   | 0           | 0           | - 4.60517   | - 4.60517   |
| ùêæ TP,CMP-Neu5Ac | 6.217368    | 6.105463    | 6.257868    | 6.379847    | 6.20563     | 6.534773    |

Table S4. The initial Golgi model parameter values used in ANMPC.

| Variable      | Ground truth   | Init_0    | Init_1    | Init_2    | Init_3    | Init_4    |
|---------------|----------------|-----------|-----------|-----------|-----------|-----------|
| ùêæ ùëë,OS1 ManI  | 4.075253       | 6.405228  | 1.800058  | 1.800058  | 1.800058  | 6.405228  |
| ùêæ ùëë,OS2 Man1  | 4.638963       | 2.397895  | 7.003065  | 2.397895  | 2.397895  | 7.003065  |
| ùêæ ùëë,OS3 Man1  | 3.408208       | 1.12493   | 5.7301    | 1.12493   | 5.7301    | 1.12493   |
| ùêæ ùëë,OS4 Man1  | 4.251972       | 6.608001  | 2.00283   | 6.608001  | 6.608001  | 2.00283   |
| ùêæ ùëë,OS6 Man2  | 5.109051       | 2.995732  | 7.600902  | 2.995732  | 7.600902  | 2.995732  |
| ùêæ ùëë,OS7 Man2  | 4.513693       | 6.907755  | 2.302585  | 6.907755  | 2.302585  | 6.907755  |
| ùêæ ùëë,OS5 GnT1  | 4.384545       | 6.870053  | 6.870053  | 2.264883  | 2.264883  | 2.264883  |
| ùêæ ùëë,OS9 GnT2  | 3.958708       | 6.877296  | 2.272126  | 6.877296  | 6.877296  | 2.272126  |
| ùêæ ùëë,OS6 FucT  | 3.942005       | 6.663133  | 2.057963  | 4.292903  | 2.667411  | 4.85936   |
| ùêæ ùëë,OS9 GalT  | 8.498685       | 8.483642  | 8.483617  | 8.501296  | 8.508624  | 8.499496  |
| ùêæ ùëë,OS12 GalT | 7.462721       | 7.469098  | 7.454398  | 7.461404  | 7.459033  | 7.467818  |
| ùêæ ùëë,OS13 SiaT | 10.57627       | 12.85055  | 8.245384  | 8.245384  | 8.245384  | 12.85055  |
| ùêæ ùëë,Mn GnT1   | - 5.20985      | - 7.51106 | - 7.51106 | - 2.90589 | - 2.90589 | - 6.98216 |
| ùêæ ùëë,Mn GnT2   | - 5.21677      | - 5.54648 | - 5.06692 | - 5.05458 | - 4.93477 | - 5.53594 |
| ùêæ GalT        | - 2.13271      | - 5.5675  | - 5.5675  | - 5.5675  | - 0.96233 | - 5.5675  |

| ùêæ ùëë,UDP-GlcNAc GnT1   |   5.113426 |   2.833213 |   2.833213 |   7.438384 |   7.438384 |   2.833213 |
|-----------------------|------------|------------|------------|------------|------------|------------|
| ùêæ ùëë,UDP-GlcNAc GnT2   |    6.35457 |    4.56435 |    9.16952 |    9.16952 |    9.16952 |    4.56435 |
| ùêæ ùëë,GDP-Fuc FucT      |    3.56357 |    1.52606 |    6.13123 |    2.80319 |    5.44441 |    3.08385 |
| ùêæ ùëë,UDP-Gal GalT      |    5.61602 |    6.47697 |    6.47697 |    6.47697 |    2.94314 |    6.47697 |
| ùêæ ùëë,CMP-Neu5Ac SiaT   |    3.91967 |    1.60944 |    6.21461 |    6.21461 |    6.21461 |    1.60944 |

Table S5. ANMPC results with and without a bleed stream (Init\_1; partial measurements; Œîùë°prep = 4 h).

|            |   Viability at harvest (%) |   GI (mg L - 1 ) | Constraint status   |
|------------|----------------------------|------------------|---------------------|
| No bleed   |                      60.75 |           395.25 | Feasible            |
| With bleed |                      65.9  |           368.28 | Feasible            |

Table S6. ANMPC results with and without a bleed stream (Init\_2; partial measurements; Œîùë°prep = 4 h).

|            |   Viability at harvest (%) |   GI (mg L - 1 ) | Constraint status   |
|------------|----------------------------|------------------|---------------------|
| No bleed   |                      57.21 |           415.79 | Infeasible          |
| With bleed |                      72.07 |           279.19 | Feasible            |

Table S7. ANMPC results with and without a bleed stream (Init\_3; partial measurements; Œîùë°prep = 4 h).

|            |   Viability at harvest (%) |   GI (mg L - 1 ) | Constraint status   |
|------------|----------------------------|------------------|---------------------|
| No bleed   |                      56.87 |           417.93 | Infeasible          |
| With bleed |                      65.27 |           363.95 | Feasible            |

Table S8. ANMPC results with and without a bleed stream (Init\_4; partial measurements; Œîùë°prep = 4 h).

|            |   Viability at harvest (%) |   GI (mg L - 1 ) | Constraint status   |
|------------|----------------------------|------------------|---------------------|
| No bleed   |                      56.37 |           415.74 | Infeasible          |
| With bleed |                      64.8  |           374.16 | Feasible            |