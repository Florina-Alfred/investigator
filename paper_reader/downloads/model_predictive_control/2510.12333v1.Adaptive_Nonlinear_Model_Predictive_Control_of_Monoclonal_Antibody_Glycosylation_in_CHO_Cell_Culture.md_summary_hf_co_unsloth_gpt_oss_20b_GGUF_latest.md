**Title & Citation**  
*Adaptive Nonlinear Model Predictive Control of Monoclonal Antibody Glycosylation in CHO Cell Culture*  
Yingjie Ma, Jing Guo, Alexis B. Dubs, Krystian K. Ganko, Richard D. Braatz – Massachusetts Institute of Technology, Cambridge, MA 02139, USA  

---

## Abstract  
The paper presents an **Adaptive Nonlinear Model Predictive Control (ANMPC)** framework for shaping the N‑linked glycosylation of monoclonal antibodies (mAbs) cultivated in Chinese hamster ovary (CHO) cells.  
A previously‐developed **multiscale Partial Differential‑Algebraic Equation (PDAE) model** links extracellular media to intracellular Golgi reactions, allowing prediction of glycan distribution and mAb titer.  
ANMPC finds the control actions online: at each sampling instant it estimates model parameters from all available measurements, then solves a **shrinking‑horizon optimization** to compute the next feeding decision (only the first move is executed).  
When the plant deviates from the model or when constraints are violated, a soft‑constraint version keeps the problem feasible.  
Computation is accelerated by **Parallel Quasi‑Steady‑State (QSS)** simulations and a **Control‑Vector Parameterization (CVP)** formulation.  
Case studies demonstrate that, starting with substantial parameter mismatch, the controller mitigates the error and yields **GI (galactosylation index)** up to **130 % higher** than open‑loop optimisation and **96 % higher** than state NMPC, when a minimal day‑1 galactose feed is imposed.  
With fewer online measurements and a longer 4 h preparation window, performance loss is negligible.  
The results confirm that ANMPC can actively shape glycan profiles in silico and provide a viable route toward closed‑loop glycosylation control.

---

## 1. Introduction & Motivation  
- Glycosylation of mAbs is a **Critical Quality Attribute (CQA)**; the Fc‑region glycan composition strongly influences ADCC, CDC, serum clearance, and overall therapeutic efficacy.  
- The biosynthetic pathway is a **non‑template enzymatic network** of thousands of coupled reactions in the ER and Golgi; consequently, the glycan distribution is inherently heterogeneous and difficult to predict.  
- Conventional process designs focus on productivity or on extracellular metabolite concentrations; they ignore intracellular glycan dynamics, which limits the ability to meet tight glycan specifications.  
- Recent multiscale mechanistic models (e.g., Kotidis et al. [21]) couple the extracellular reactor state to the Golgi enzyme network and can be used for **open‑loop optimisation**. Those offline policies however are **vulnerable to model–plant mismatch** and disturbances.  
- Advanced model‑predictive control (MPC) of bioprocesses has been studied, but the computational cost (20–40 h per optimisation for the full PDAE model) renders it impractical. Linearisation approaches exist but are only accurate near a chosen operating point.  
- **Goal of the present work:** merge a high‑fidelity multiscale model with an adaptive MPC that can **continually update model parameters** from real‑time measurements, thereby reducing mismatch and maintaining good performance under practical constraints (limited measurements, assay delays, etc.).

---

## 2. Methods / Approach  

### 2.1 Multiscale Glycosylation Model  
- **Three tiers (Fig. 1):**  
  1. **Cell Culture DAE**: unstructured model for viable cell density, extracellular metabolites, product titer, and cell specific rates (growth, death).  
  2. **NSD Synthesis DAE**: converts extracellular metabolites into intracellular nucleotide‑sugar donors (GDP‑Man, GDP‑Fuc, UDP‑Gal, UDP‑GalNAc, UDP‑Glc, UDP‑GlcNAc, CMP‑Neu5Ac).  
  3. **Golgi PAM (PDE)**: a plug‑flow reactor representation, with 33 oligosaccharides and 43 reactions (Fig. 3). The reaction rates combine **Michaelis–Menten**, **Sequential Bi‑Bi**, and **Random‑Order Bi‑Bi** kinetics (Eq. {43–45}).  

- Full dynamic equations: 30 ODEs + 34 PDEs + many algebraic relations, with parameter set ≈ 100 values.  
- Parameters are detailed in Supplementary tables S2–S5 (e.g., kinetic constants, yield coefficients).  

### 2.2 Adaptive NMPC

1. **Parameter Estimation**  
   - Two estimation strategies: **EHE (extending‑horizon estimation)** vs **FHE (full‑horizon estimation)**.  
   - MAP (Prior ∝ Cov^-1) for cell‑culture parameters; MLE for NSD & Golgi parameters.  
   - Constraints on state bounds are added in cons‑FHE.  
   - Estimation performed in the **log‑space** of parameters to avoid ill‑conditioning.  

2. **Control Vector Parameterization (CVP)** for the optimisation: finite‑dimensional decision variables encode the control sequence as a set of time‑piecewise constants (Eq. 5), eliminating the need for a full direct‑collocation scheme.  

3. **QSS Algorithm** (Algorithm 2) – leverages the timescale separation between the fast Golgi reactions and the slower cell‑culture dynamics.  
   - Step 1: integrate cell‑culture + NSD model to obtain external environment.  
   - Step 2: for each time point, solve the Golgi steady‑state DAE to obtain intra‑Golgi dye concentrations ([GLY_intra]).  
   - Step 3: reintegrate full cell‑culture model using the intra‑Golgi parameters to generate the full trajectory.  

4. **Dynamic Optimization**  
   - Offline problem forms the baseline: **DO_off‑line** (Eq. 28) with full horizon, free input.  
   - In the loop: **DO_k** (Eq. 29) replaces the nominal parameters by their current estimates and uses a shrinking horizon [t_k, T].  
   - If infeasible, a **soft‑constraint** ℱ (soft‑DO_k) (Eq. 32) with slack variables and penalty weights ρ (Table 6) keeps it feasible.  

5. **ANMPC Loop** – described by Algorithm 1, implemented with a 2 h or 4 h preparation time for analysis/optimization.  

### 2.3 Feed Media  
- Three feeds available: **medium (176 mM glucose, 27 mM anthranine, …), galactose solution (3600 mM), uridine solution (2000 mM)** (Table 1).  
- Input constraints: 0 ≤ F_s ≤ 100 L h^−1 (input windows ≤ 0.01 h).  
- Viability constraint: final viable cell density ≥ 60 %.  

---  

## 3. Experiments / Data / Results  

### 3.1 Open‑Loop, State NMPC, and ANMPC with Full Measurement  

| Controller | Merit (GI in mg L^−1) | # Init Set | Remarks |
|------------|-----------------------|------------|---------|
| Ground‑Truth (DO_offline with true p) | 404.00 | — | Optimal benchmark |
| Open‑loop (DO_k with Init_0) | 185.88 | 1 | Poor performance due to mismatch |
| State NMPC (fixed p, measured x) | 276.08 | 1 | Terminal feasibility issue for some Init |
| ANMPC (adaptive p, measured x) | 216.82 | 1 | Significant improvement, but still below 404 |

**Commentary:**  
- **Claim 1:** ANMPC reduces GI errors by ≈ 60 % compared to open‑loop (Table 8).  
- **Evidence:** Table 8 shows merit of 216.82 vs 185.88 for open‑loop; 380.37 for ANMPC after a minimal galactose lower bound (Section 5.3).  

### 3.2 Impact of Galactose vs Uridine Supplements (Table 7)  

| Feed | Gain in GI (relative to batch) | Observed Effect |
|------|------------------------------|-----------------|
| None | +0 % | 174 mg L^−1 |
| Medium only | +42 % | 247 mg L^−1 |
| Medium+Gal | +64 % | 404 mg L^−1 |
| Medium+Urd | +64 % | 405 mg L^−1 |
| Medium+Gal+Urd | +64 % | 405 mg L^−1 |

**Observation:**  Galactose is slightly more beneficial and less dosage‑sensitive than uridine (Fig. 6b).  

### 3.3 Sensitivity to Day‑1 Galactose Dose (Figure 7)  

- **Robustness to Gal:**  Varying Gal from 0–15 mL on Day 3–4 shows GI changes < 10 % within 10–15 mL; becomes sensitive only below 5 mL.  
- **Contrast with Uridine (Fig. 6a):** GI collapses sharply when Urd worsens slightly from optimum (0.014 mL).  

**Claim 2:** Sensitive control of uridine, forgiving control of galactose.  

### 3.4 ANMPC with Partial Measurement and 4 h Preparation (Table 10)  

| Scenario | Avg Merit |
|----------|-----------|
| Full meas + 2 h | 388.41 |
| Partial (no Asn, Asp, HM, FA1G1, SIA, NSDs) + 2 h | 389.74 |
| Partial + 4 h | 387.07 |

**Inference:** Even with limited measurements and 4 h delay, ANMPC remains robust; performance drop < 2 %.  

### 3.5 Impact of Bleeding Stream (Fig. 10 & Tables S5–S8)  

- When a bleed stream (15 mL L^−1 at start‑mid, 1 h later) is optionally added, GI can be kept high while maintaining viability constraints, but bleed may reduce GI if not needed.  

---  

## 4. Discussion & Analysis  

- **Model–Plant Mismatch** is the root cause of poor performance in open‑loop and state NMPC; ANMPC adaptively updates parameters from measurements, significantly reducing error (Fig. 10).  
- **Feed Strategy**: only one of Gal or Urd needs to be supplied; Gal is favored due to larger robustness. Simultaneous supplementation does not improve GI further because optimizer drives Gal feed to zero if Urd present.  
- **Optimization Feasibility**: soft constraints in soft‑DO_k efficiently prevent infeasibility; adjustable weights ρ were tuned (Table 6).  
- **Computational Efficiency**: QSS + CVP achieves < 2 h per control move (Sect. 5.2).  
- **Practical Deployment**: realistic measurement availability (partial) and 4 h preparation have negligible impact.  
- **Limitations & Open Questions**:  
  - **Coverage of the full model** is still limited by data availability; measurement of all NSDs is impractical.  
  - **Stochastic disturbances** (e.g., feed variability, assay noise) not explicitly addressed; future work proposes stochastic or chance‑constrained ANMPC.  
  - **Experimental validation** remains to be performed in future studies.  

---  

## 5. Conclusions  

- A multiscale PDAE model can predict mAb glycosylation in a fed‑batch CHO bioreactor.  
- Using ANMPC, model parameters can be updated online with all available measurements, and the resulting shrinking‑horizon optimisation yields up to **130 % improvement** vs open‑loop and **96 % vs state NMPC** when a minimal Galactose feed on day‑1 is enforced.  
- Even with fewer measurements and longer analysis time, performance loss is negligible, demonstrating practical viability.  
- The results advocate ANMPC as a promising strategy for closed‑loop control of mAb glycosylation.

---  

## 6. Key Claims & Contributions  

| Claim | Statement | Supporting Evidence |
|-------|-----------|----------------------|
| 1 | ANMPC mitigates model–plant mismatch in glycosylation control | Table 8, Fig. 10 (GI error reduction) |
| 2 | Galactose supplementation is more robust than uridine | Table 7, Fig. 6 |
| 3 | A minimal day‑1 Gal feed is sufficient to excite Gal‑related dynamics | Table 9 |
| 4 | ANMPC is robust to limited measurement and longer preparation times | Table 10 |
| 5 | QSS+CVP yields real‑time computability (< 2 h per step) | Sect. 5.2, Algorithm 2 |
| 6 | Soft‑constraint optimisation preserves feasibility | Soft‑DO_k formulation, Table 6 |

---  

## 7. Definitions & Key Terms  

| Term | Definition |
|------|------------|
| **GAL** | N‑linked glycosylation |  
| **MGI** | Metric: galactosylation index, computed from extracellular glycoform fractions (Eq. 27) |
| **ANMPC** | Adaptive Nonlinear Model Predictive Control – a loop that updates model parameters, then solves a shrinking‑horizon NMPC problem |
| **DO_offline** | Offline dynamic optimisation over the full horizon (Eq. 28) |
| **CVP** | Control‑Vector Parameterization: representing the decision vector with finite‐dimensional parameters |
| **QSS** | Quasi‑Steady‑State: approximating Golgi reactions as steady state per time point |
| **MAP** | Maximum a posteriori estimator: weighted least‐squares using prior covariance |
| **MLE** | Maximum Likelihood Estimator: unweighted least‐squares |
| **Soft Constraints** | Constraints that can be violated at a penalty cost |
| **NSD** | Nucleotide Sugar Donor |
| **GO** | Golgi Oligosaccharide; 33 species |
| **PDAE** | Partial Differential‑Algebraic Equations |

---  

## 8. Important Figures & Tables  

- **Fig. 1** – Diagram of 3‑tier multiscale model.  
- **Fig. 2** – Metabolic network of extracellular reactions.  
- **Fig. 3** – Golgi glycosylation reaction network.  
- **Fig. 4** – Timeline of the ANMPC algorithm.  
- **Fig. 5** – Optimal trajectories for different feed strategies (medium, medium+Gal, medium+Urd).  
- **Fig. 6** – Sensitivity of harvested GI to Urd/ Gal feed volume.  
- **Fig. 7** – Effect of a day‑1 minimal Gal feed.  
- **Fig. 8** – GI prediction error evolution for various controllers.  
- **Table 5** – ANMPC algorithm parameters.  
- **Table 7** – Optimised fed‑batch performance with different feeds.  
- **Table 8** – Merit comparison across controllers and initial parameter sets.  
- **Table 9** – Merit after imposing a 1 mL Gal lower bound.  
- **Table 10** – ANMPC results with partial measurement and 4 h prep time.  
- **Tables S2–S5** – Full parameter sets for model, NSD, Golgi sub‑models.  

---  

## 9. Limitations & Open Questions  

- **Accurate NSD measurement** is not available in practice; the model remains partially unobservable.  
- **Stochastic disturbances** (e.g., feed variability, measurement noise) not explicitly handled.  
- **Scalability** to bioreactors with larger volumes or continuous perfusion is untested.  
- **Experimental validation** is planned; current results are purely simulation‑based.  

---  

## 10. References to Original Sections  

- **Introduction** – Sec. 1 (p. 2).  
- **Model Description** – Sec. 2 (p. 4–10).  
- **ANMPC Algorithm** – Alg. 1 (p. 13).  
- **Parameter Estimation** – Sec. 4.2, Eq. (67).  
- **Dynamic Optimization** – Sec. 4.1, Eq. (29).  
- **Soft Constraints** – Eq. (32), Table 6.  
- **Computational Approach** – Alg. 2, Sec. 4.3.  
- **Case Studies** – Sec. 5 (p. 15+).  
- **Results Tables** – Table 7–10.  
- **Conclusion** – Sec. 6 (p. 22).  

---  

## 11. Executive Summary (Key Takeaways)  

- A highly detailed multiscale model can be embedded in a real‑time MPC loop with online parameter adaptation.  
- The adaptive loop (ANMPC) can bring the plant dynamics into agreement with the model, achieving superior galactosylation control metrics.  
- Practical constraints (limited measurements, 4 h analysis delay) do **not** impair performance, suggesting commercial viability.  
- The approach outperforms both open‑loop optimised policies and state NMPC by **~130 %** (open‑loop) and **~96 %** (state NMPC).  
- Future work will address stochastic disturbances and experimental validation.

---  

## 12. Supplementary Material  

- **Additional Tables (S1–S5):** full parameter sets, initialisation sets, and bleed‑stream results.  
- **Code Release:** to be made public upon acceptance; can be requested by reviewers.  

---