**Title & Citation**  
Safe Landing on Small Celestial Bodies with Gravitational Uncertainty Using Disturbance Estimation and Control Barrier Functions  
Felipe Arenas‑Uribe, T. Michael Seigler, and Jesse B. Hoagg. 2025.  

**Abstract**  
The paper addresses the difficulty of soft‑landing a spacecraft on a small celestial body (SCB), where large uncertainties in the gravitational field and a poorly mapped environment demand high autonomy and formal safety guarantees.  
A control architecture is proposed that combines: (i) a nonlinear extended high‑gain observer (EHGO) that estimates disturbances produced by gravitational model errors; (ii) a full‑state feedback‑linearizing, disturbance‑canceling controller that tracks an offline trajectory; and (iii) a control‑barrier‑function (CBF) based minimum‑intervention layer that enforces state and input constraints throughout the maneuver.  
Numerical simulations on fuel‑optimal reference trajectories for two asteroid models (uniformly‑ and non‑uniformly‑dense ellipsoids) show that the controller achieves precise and safe soft‑landing, establishing its potential for autonomous SCB missions.

---

## Introduction & Motivation  

- **Problem Context** – Soft‑landing small celestial bodies is valuable for scientific and planetary‑defense missions (e.g., OSIRIS‑REx, Hayabusa, Rosetta).  The mission is challenged by (a) ~10⁻¹⁵ % mass measurement error \[1\], (b) higher‑order gravitational effects from irregular shape and non‑uniform density (captured in spherical‑harmonic or Bessel parametrizations \[2\]), and (c) limited communication and readiness for high‑autonomy operations.  
- **Existing Approaches** – Trajectory generation and tracking control have been studied with H∞, adaptive, and MPC laws \[5–10\].  Conventional techniques provide robustness **but not** formal state‑constraint guarantees.  
- **Why CBF?** – Control‑Barrier‑Functions were introduced in \[11\] and applied to spacecraft in several contexts (proximity, rendezvous, attitude, formation flying) \[12–17\].  However, their use for SCB soft‑landing had not been explored.  
- **Goal** – Design a controller that:  
  1. tracks an offline generated trajectory,  
  2. estimates and cancels disturbances due to gravitational uncertainty, and  
  3. guarantees safety constraints (position, glide‑slope, speed, thrust limits).  

---

## Methods / Approach  

### 1. System Model  

- Translational dynamics:  
  *\(\dot r = v \)*  
  *\(m \dot v = m\,\omega \times v - m\,\omega \times (\omega \times r) + \nabla U(r) + u\)* (Eq. (1),(2))  
  *\(m(t) = m_w\exp(-\alpha t),\;\alpha =\tfrac{1}{I_{sp}g_E}\)* (Eq. (3))  
- \(U: \mathbb R^3 \to \mathbb R\) is the spacecraft’s gravitational potential; the nominal model \(U_m\) is the point‑mass Newtonian potential.  
- Disturbance \(w(x) = \nabla U_\Delta(r)\) where \(U_\Delta = U - U_m\); assumption (A1): \(U_\Delta\) is bounded.

### 2. Soft‑Landing Task  

- Desired final state: position \(r_f\), velocity \(v_f=\omega \times r_f\).  
- Tolerances: allowable landing radius \(r_\ell\), altitude offset \(\delta\), speed error \(\varepsilon\).  
- Constraints:  
  *\( \psi_1(x) \ge 0\) : minimum speed that relaxes with distance.  
  *\( \psi_2(x) \ge 0\) : glide‑slope constraint (blue cone in Fig. 1).  
  *\( \psi_3(u)\ge 0\) and \( \psi_4(u)\ge 0\) : thrust bounds \(T_{min}\le \|u\|\le T_{max}\).  

### 3. Controller Architecture (Fig. 2)  

Three execution layers:  

1. **EHGO for Disturbance Estimation** – Observer dynamics \(\dot\nu = \tau v - \nu,\;\nu(0)=\tau v_0\).  
   Estimate \(\hat w = \tau v -\nu\).  *Fact 1:* With bounded \(w\) and \(\dot w\) the estimation error \(\tilde w = w-\hat w\) satisfies \(\|\tilde w\|\to [0,\eta/\tau]\) exponentially.

2. **Feedback‑Linearizing & Disturbance‑Canceling Control** – Desired feed‑forward control  
   \(u_d = m\,\dot v_0 + 2k_p e + 2k_v e - \hat w \) (Eq. (13));  
   where \(e=r-r_r\).  *Fact 2:* For sufficiently large \(\tau\), \(\dot e\) and \(\dot v\) converge exponentially; hence tracking holds asymptotically.

3. **CBF‑Based Safety Layer** –  
   *State CBFs*: introduce smooth relaxations \(h_{1,0},h_{2,0},h_{3,0}\) for constraints \(\psi_1,\psi_2,\psi_3\) and input CBFs \(h_{3,0}, h_{4,0}\) for thrust limits (Eq. (15‑17)).  
   *Control dynamics*: Replace \(u\) by a first‑order dynamics \(\dot u = a(\zeta - u)\) (Eq. (21)), where \(\zeta\) is the *surrogate* control that appears in the CBF derivative.  
   *Higher‑order CBFs*: Construct \(h_{1,1},h_{2,1},h_{2,2}\) and then a composite relaxed‑CBF  
   \[h(x,u)= \operatorname{softmin}_\rho(h_{1,1},h_{2,1}h_{2,2})\] (Eq. (31)) with \(\rho>0\).  
   *Feasible set*: \(S = \{(x,u): h(x,u)\ge 0\}\subseteq \Phi\) (Eq. (33)).  

### 4. Optimization & Closed‑Loop Control  

Objective: minimize deviation of \(\zeta\) from the desired surrogate \(\zeta_d\) while satisfying the CBF condition
\[b(x,u,\nu,\zeta,\kappa) = \dot h(x,u,\nu,\zeta,\kappa) + \alpha(h(x,u))\ge 0.\]  
Cost: \(J = \|\zeta-\zeta_d\|^2 + \gamma\kappa^2\) (Eq. (35)).  
Closed form solution (Eq. (37‑40)) gives \(\zeta^*\) that injects the interaction index \(d^*\) into the surrogate control.  
*Theorem 1:* The resulting pair \((\zeta^*,\kappa^*)\) minimises \(J\) subject to \(b\ge 0\).  
*Theorem 2:* Under (A5) and \(\hat w=w\), if \((x_0,u_0)\in S\) then the closed‑loop trajectory satisfies \((x(t),u(t))\in S\subseteq\Phi\) for all future time, guaranteeing all safety constraints.

---

## Experiments / Data / Results  

### Simulation Settings  

- Asteroid models:  
  1. *Ellipsoidal* (a=1000 m, b=c=400 m, density 1380 kg/m³).  
  2. *Irregular* (union of two ellipsoids with densities 1460 kg/m³ and 1380 kg/m³).  
  For both, nominal mass reduced by 25 % to simulate uncertainty.  
- Spacecraft: wet mass \(m_w=700\) kg, dry mass \(m_d=500\) kg, specific impulse \(I_{sp}=225\) s, thrust limits \(T_{min}=5\) N, \(T_{max}=20\) N.  
- Reference trajectory: fuel‑optimal offline solution with full hard constraints (from \[4\]).  
- Control loop: 25 Hz update; desired control gains \(k_p=0.002,\;k_v=0.09\); observer gain \(\tau=10\); control‑dynamics parameters \(a=3,\;\sigma=5\).  
- CBF parameters: \(\alpha_1(h)=h,\;\beta_1=\beta_2=\alpha=10h,\;\rho=40,\;\gamma=10^{10}\).  
- Scaling constants for candidate‑CBFs: \(k_{vel}=10,\;k_{gs}=10,\;k_u=10\).  

### 1. Ellipsoidal Asteroid (Uniform Density)  

- Initial state: \(r_0=[1927.2,\,-374.6,\,-954]^\top\,m;\;v_0=[-1.64,\,-3.02,\,-3.64]^\top\,m/s\).  
- Final state: \(r_f=[400,0,0]^\top\,m;\;v_f=[0,0,0.174]^\top\,m/s\).  
- *Landing time:* \(t_l=839.88\) s.  
- Final errors: \(\|r(t_l)-r_f\|=0.4168\) m; velocity error \(0.278\) m/s; glide‑slope residual \(0.0047\) m.  
- **Figure 3** – shows successful landing trajectory.  
- **Figure 4** – normalized estimation error \(\|\tilde w\|\) tracking first‑order dynamics; shows exponential convergence to a bounded set that grows as the spacecraft approaches the body.  
- **Figure 5** – all safety constraints remain positive for the whole maneuver.  
- **Figure 6** – comparison of desired control \(u_d\) and applied control \(u\); the latter is modified by the CBF–layer only during the last 120 s, the period in which other controllers would have violated the position constraint.

### 2. Irregular Asteroid (Non‑Uniform Density)  

- Initial state: same as before; final desired state \(r_f=[600,0,-253.5]^\top\,m;\;v_f=[0,0,0.2618]^\top\,m/s\).  
- *Landing time:* \(t_l=628.2\) s.  
- Final errors: \(\|r(t_l)-r_f\|=0.5045\) m, ⟨\(e_s^\top(r(t_l)-r_f)\)⟩\(=0.4669\) m, velocity error \(0.0096\) m/s.  
- **Figure 7** – landing trajectory; validates successful landing.  
- **Figure 8** – disturbance estimate error remains negligible and non‑zero, confirming *Fact 1*.  
- **Figure 9** – safe-set constraints satisfied throughout.  
- **Figure 10** – surrogate control \(u_d\) vs applied \(u\); adjustments made primarily during the final 28 s.

---

## Discussion & Analysis  

- **Disturbance Estimation** – The EHGO effectively captures unmodeled gravitational perturbations; the error bound in *Fact 1* ensures that even with large mass uncertainty, the estimation remains within a small, bounded set.  
- **Tracking Performance** – *Fact 2* proves that with large observer gain the closed‑loop error dynamics are exponentially stable; simulation data confirm that the spacecraft follows the offline reference closely (`radius ≈ 1 m` before final approach).  
- **Constraint Satisfaction** – By converting state constraints into smooth CBFs and treating input limits via control dynamics, the combined CBF framework ensures forward invariance of the safe set.  
- **Minimal Intervention** – The quadratic optimization leaves the nominal control untouched while providing the minimal adjustment necessary for safety, which is crucial for aggressive, fuel‑optimal trajectories.  
- **Computational Efficiency** – The closed‑form solution of the control law and low‑order dynamics (\(a=3,\sigma=5\)) make the controller suitable for real‑time onboard implementation.  
- **Complementarity to Existing Work** – Previous works on SCB landing employed robust or MPC methods without rigorous safety guarantees; the present paper bridges this gap by marrying disturbance estimation and CBFs, the latter having a solid theoretical foundation in \[11–17\].

---

## Conclusions  

- A three‑layer control architecture is introduced for safe soft‑landing on small celestial bodies under gravitational uncertainty.  
- The approach combines: EHGO‑based disturbance estimation; a feedback‑linearizing, disturbance‑canceling tracking controller; and a CBF‑based minimum‑intervention safety filter.  
- Simulations on two representative asteroid models demonstrate that the method achieves the desired final position/velocity within the prescribed bounds while guaranteeing all state and input constraints, even when naïve controllers fail.  
- The architecture is computationally light and well‑suited to onboard autonomy.  
- Future work: extend to coupled attitude and position control, over‑actuated vehicles, and more general proximity/rendezvous scenarios.

---

## Key Claims & Contributions  

| Claim | Supporting Evidence |
|-------|---------------------|
| **C1**: Disturbance estimation error \(\|\tilde w\|\) converges to a set \([0,\eta/\tau]\). | *Fact 1* (theorem of EHGO). |
| **C2**: Feedback‑linearizing controller tracks reference exponentially. | *Fact 2* (exponential bounds on \(\dot e, \dot v\)). |
| **C3**: Composite soft‑minimum CBF \(h(x,u)\ge0\) guarantees all input/state constraints. | Construction of \(h_{1,1},h_{2,1},h_{2,2}\) and proofs in Proposition 1 and 2. |
| **C4**: Optimization (35) yields a control \(\zeta^*\) that minimally deviates from \(\zeta_d\) while maintaining safety. | *Theorem 1* (solution of convex QP). |
| **C5**: The closed‑loop controller keeps \( (x(t),u(t))\in S \subseteq \Phi\) for all \(t\). | *Theorem 2* (forward invariance). |
| **C6**: Simulation results confirm constraint satisfaction and successful landing. | Figures 3‑10. |

---

## Definitions & Key Terms  

- **Spacecraft State \(x=[r^\top,v^\top,m]^\top\)** – position, velocity, and instantaneous mass.  
- **Gravitational Potential \(U\)** – true potential of the asteroid.  
- **Nominal Potential \(U_m\)** – used in the controller (point‑mass).  
- **Disturbance \(w(x)=\nabla U_\Delta(r)\)** with \(U_\Delta=U-U_m\).  
- **EHGO** – Extended High‑Gain Observer; dynamics \(\dot\nu = \tau v-\nu\).  
- **CBF** – Control Barrier Function; a function \(h(x,u)\) whose superlevel set is forward invariant if \(\dot h + \alpha(h)\ge0\).  
- **softmin\(_\rho\)** – smooth relaxation of \(\min\); defined as \(-\tfrac{1}{\rho}\log\sum_i e^{-\,\rho z_i}\).  
- **Higher‑order CBF** – CBFs of relative degree >1 constructed via recursive Lie derivatives (see Ref. [20]).  
- **Surrogate Control \(\zeta\)** – auxiliary input chosen to satisfy CBF inequality (control‑dynamics formulation).  
- **Nominal Feed‑forward Control \(u_d\)** – desired thrust computed from trajectory reference and disturbance estimate.

---

## Important Figures & Tables  

| Figure | Content | Significance |
|--------|---------|---------------|
| 1 | Spacecraft in orbit; blue cone shows glide‑slope constraint | Visual of safety constraints. |
| 2 | Block diagram of controller architecture | Shows EHGO → Tracking → CBF layer. |
| 3 | Ellipsoidal asteroid landing trajectory | Demonstrates successful landing. |
| 4 | Normalized disturbance estimation error vs time | Shows EHGO convergence. |
| 5 | State/input constraint plots (all positive) | Affirms safety during entire maneuver. |
| 6 | Desired control \(u_d\) vs applied \(u\) | Shows real‑time moderation by CBF layer. |
| 7 | Irregular asteroid landing trajectory | Demonstrates second scenario. |
| 8 | Disturbance estimation error vs time | EHGO performance for irregular case. |
| 9 | State/input constraints for irregular case | Safety maintained. |
|10 | Desired vs applied control for irregular case | CBF active primarily near landing. |

---

## Limitations & Open Questions  

- **Model‑based** – Assumes the body’s rotational dynamics are known only to moderate accuracy; unmodeled attitude disturbances are not explicitly considered.  
- **Observer Tuning** – Selection of observer gain \(\tau\) influences cost–constraint trade‑off; its systematic tuning for different bodies remains to be addressed.  
- **Non‑linear Disturbance** – The EHGO linearizes the dynamics; strongly non‑linear gravitational singularities may challenge bounds.  
- **Admittance to Larger Disturbances** – The bound \(\eta/\tau\) can degrade if mass uncertainties exceed 25 %.  
- **3° attitude** – The current architecture ignores the attitude dynamics that are crucial for realistic spacecraft; future extension is planned.  

---

## References to Original Sections  

- **Problem Formulation** – § II (A).  
- **EHGO Design** – § III (A).  
- **Tracking Controller** – § III (B).  
- **CBFs** – § IV (A).  
- **Safety‑layer Optimization** – § IV (C).  
- **Simulation Details** – § V.  
- **Conclusions** – § VI.  

---

### Executive Summary (Optional)  

- Introduced high‑gain observer for gravitational disturbance estimation.  
- Developed full‑state feedback‑linearizing controller that cancel disturbances.  
- Designed control‑barrier‑function hierarchy (soft‑minimum, higher‑order) to enforce all state and thrust constraints.  
- Closed‑form optimization yields minimal intervention ensuring safety while preserving nominal performance.  
- Numerical simulations on two realistic asteroid models confirm constraint satisfaction and final accuracy.  
- Approach is computationally light and presented for onboard implementation.  

---