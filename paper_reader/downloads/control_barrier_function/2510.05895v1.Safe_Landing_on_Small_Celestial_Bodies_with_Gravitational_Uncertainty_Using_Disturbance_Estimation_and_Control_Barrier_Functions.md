## Safe Landing on Small Celestial Bodies with Gravitational Uncertainty Using Disturbance Estimation and Control Barrier Functions

Felipe Arenas-Uribe, T. Michael Seigler, and Jesse B. Hoagg

Abstract -Soft landing on small celestial bodies (SCBs) poses unique challenges, as uncertainties in gravitational models and poorly characterized, dynamic environments require a high level of autonomy. Existing control approaches lack formal guarantees for safety constraint satisfaction, necessary to ensure the safe execution of the maneuvers. This paper introduces a control that addresses this limitation by integrating trajectory tracking, disturbance estimation, and safety enforcement. An extended high-gain observer is employed to estimate disturbances resulting from gravitational model uncertainties. We then apply a feedback-linearizing and disturbance-canceling controller that achieves exponential tracking of reference trajectories. Finally, we use a control barrier function based minimum-intervention controller to enforce state and input constraints through out the maneuver execution. This control combines trajectory tracking of offline generated reference trajectories with formal guarantees of safety, which follows common guidance and control architectures for spacecraft and allows aggressive maneuvers to be executed without compromising safety. Numerical simulations using fuel-optimal trajectories demonstrate the effectiveness of the controller in achieving precise and safe soft-landing, highlighting its potential for autonomous SCB missions.

## I. INTRODUCTION

Small celestial body (SCB) exploration missions have attracted significant attention, both for their scientific value and their relevance to planetary defense. Sample return missions have provided insights into the formation and composition of celestial bodies, while near-Earth objects are also recognized as potential hazards, driving active monitoring and mitigation research. Notable examples include NASA's OSIRIS-REx, JAXA's Hayabusa and ESA's Rosetta missions. Despite these advances, fully autonomous soft-landing on a SCB remains challenging due to uncertainties in gravitational models, poorly mapped environments, and communication delays, requiring both high autonomy and safety guarantees throughout the maneuver.

Uncertainties in gravitational field models stem primarily from estimating SCB mass, which typically carries a 1015% measurement error [1]. Beyond mass, gravitational field models must also capture higher-order gravitational effects arising from an SCB's irregular shape and non-uniform density distribution. To account for these effects, spherical harmonics or spherical Bessel functions are commonly used [2]. However, accurately determining the associated coefficients requires high-resolution remote sensing or resource-intensive in-situ measurements [3].

F. Arenas-Uribe, T. M. Seigler, and Jesse B. Hoagg are with the Department of Mechanical and Aerospace Engineering, University of Kentucky, Lexington, KY, USA. (e-mail: felipearur@uky.edu, tmseigler@uky.edu, jesse.hoagg@uky.edu).

To meet safety requirements, guidance and control frameworks typically rely on trajectory generation algorithms that produce trajectories offline and a feedback tracking control law [4]. For a review of SCB soft-landing trajectory generation approaches see [4, Section 3.3]. Feedback trajectory-tracking controllers for these maneuvers have employed robust approaches, such as H ∞ control [5] and adaptive control [6]. Linear extended high-gain observers (EHGO) have also been applied to estimate and compensate gravitational uncertainties [7]. Other explicit guidance and control approaches include Model Predictive Control (MPC) frameworks [8]-[10].

While these approaches provide robustness to disturbances, they offer no formal guarantees that safety constraints remain satisfied throughout the maneuver. This limitation motivates the use of control barrier functions (CBFs), which have been used as a tool to guarantee safety in a dynamic system in a handful of applications [11]. CBFs have been applied to spacecraft scenarios including SCB proximity operations and flybys [12]-[14], rendezvous [15], attitude control and reorientation [16], and satellite formation flying [17]. However, their application into SCB soft-landing remains unexplored.

The primary contribution of this paper is a control for safe and optimal soft-landing on SCBs. Following recent trends in spacecraft guidance, we assume a reference trajectory is provided by an offline algorithm [4]. Unlike existing methods, we integrate trajectory tracking of the reference trajectory, disturbance estimation, and formal safety guarantees throughout the maneuver. A nonlinear EHGO estimates gravitational model uncertainties, while a feedback-linearizing, disturbancecanceling controller tracks the reference trajectory. State and input constraints are enforced via a CBF-based minimumintervention layer, ensuring safety of the system.

This architecture offers several advantages. The CBFbased layer eliminates the need for conservative planning, enabling the execution of aggressive trajectories-such as fuel-optimal maneuvers-that might otherwise risk violating safety constraints. Furthermore, the framework is computationally efficient and amenable to onboard implementation, making it suitable for autonomous spacecraft applications. Its effectiveness is demonstrated in simulation studies using fuel-optimal reference trajectories, which show consistent satisfaction of landing performance and safety constraints, highlighting the framework's applicability to real mission scenarios.

The remainder of this paper is organized as follows. Section II outlines the problem formulation. Section III presents the disturbance observer and the feedback-linearizing, disturbance-canceling control. Section IV introduces the CBF-

based constraints and formulates the safe optimal control. Finally, Section V provides numerical simulation results and in Section VI we conclude with final remarks and directions for future work.

## II. PROBLEM FORMULATION

Let h : R n → R l be continuously differentiable. Then, h ′ : R n → R l × n is defined as h ′ ( x ) ≜ ∂h ( x ) ∂x . The Lie derivatives of h along the vector field of ψ : R n → R n × l is defined as L ψ h ≜ h ′ ( x ) ψ ( x ) . Let ∥·∥ denote the 2-norm. The boundary of A ⊆ R N is denoted by bd A .

Let ρ &gt; 0 , and consider softmin ρ : R × · · · × R → R defined by

<!-- formula-not-decoded -->

which is the soft minimum , a smooth lower bound of min { z 1 , . . . , z N } .

## A. Equations of Motion

Consider an irregularly shaped celestial body (referred to as an asteroid). Consider a spacecraft orbiting about the asteroid (see Figure 1) with thrusters on its 3 orthogonal body directions. We assume that the attitude of the spacecraft is controlled separately from its position. Then, the equations of motion of the spacecraft are

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where r ( t ) ∈ R 3 is the position of the center of mass of the spacecraft relative to the geometric center of the asteroid, v ( t ) ∈ R 3 is the velocity, and r (0) = r 0 ∈ R 3 and v (0) = v 0 ∈ R 3 are the initial conditions. Moreover, m ( t ) &gt; 0 is the spacecraft's mass and u ( t ) ∈ R 3 is the thrust force. The vector ω ∈ R 3 is the asteroid's angular velocity and ω × ∈ R 3 × 3 is the skew-symmetric form of ω . Furthermore, U : R 3 → R is the asteroid's gravitational potential field. The magnitude of the thrust force is limited to [ T min , T max ] , where T max &gt; T min ≥ 0 . The spacecraft's mass is governed by

<!-- formula-not-decoded -->

where m (0) = m w &gt; 0 is the initial mass (i.e. wet mass), I sp &gt; 0 is the specific impulse of the spacecraft's thrusters and g E = 9 . 807 m s 2 is the gravitational acceleration at Earth's surface. For notational convenience, we define α ≜ 1 I sp g E . The spacecraft carries a finite amount of propellant, characterized by the available propellant mass δm ≜ m w -m d , where m d ∈ (0 , m w ) is the dry mass of the spacecraft.

## B. Gravitational Field Model and Perturbations

Regardless of the gravitational model used, two main sources of modeling error remain: measurement uncertainties in the asteroid's mass and unmodeled higher-order effects, arising either from the limitations of the chosen model or

Fig. 1. Spacecraft orbiting an irregularly shaped asteroid with non-uniform density. The blue cone represents the glideslope position constraint (7).

<!-- image -->

inaccuracies in estimating the gravitational coefficients. We consider a nominal gravitational field model and treat the aforementioned errors as perturbations.

Consider the gravitational field model U m : R 3 → R , which is assumed to be two times differentiable. Thus, the gravitational model error is

<!-- formula-not-decoded -->

We make the following assumption:

(A1) U ′ ∆ is bounded.

A common choice for U m is the point-mass Newtonian potential. While this approximation simplifies analysis and control design, it does not capture any higher-order gravitational effects. In cases where more detailed information about the asteroid's geometry and composition is available, spherical harmonic models based on constant-density ellipsoids offer a more accurate representation [2].

## C. Asteroid Soft-Landing Problem

Let x ( t ) ≜ [ r ( t ) ⊤ v ( t ) ⊤ m ( t ) ] ⊤ . Then, (1)-(3) can be written as

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where w ( x ) ≜ U ′ ∆ ( r ) ⊤ and

The asteroid soft-landing maneuver is a controlled touchdown on the surface of the asteroid, where the spacecraft achieves a pre-defined relative configuration with a final position r f ∈ R 3 , and a final velocity v f ≜ ω × r f . To achieve landing, the spacecraft's position and velocity must remain in pre-defined tolerance bounds. Let r l &gt; 0 be the allowable landing radius, δ &gt; 0 be the allowable altitude offset and ε &gt; 0 be the allowable speed error. Moreover, let ˆ e s ∈ R 3 be the local vertical unit vector of the landing site. We formalize this requirement through the following definition:

Definition 1. The spacecraft (1)-(3) lands at time t l ∈ [0 , ∞ ) if:

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

The system is subject to input and state constraints that arise from physical constraints or mission requirements. We consider the state-constraint functions

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where v min ∈ (0 , ∥ v f ∥ ] is the allowed minimum speed and θ gs ∈ [0 , π 2 ] is the landing glideslope angle. The constraint ψ 1 ( x ) ≥ 0 enforces a minimum speed, which is relaxed as the spacecraft's distance from the landing position increases. The constraint ψ 2 ( x ) ≥ 0 is a relaxation of a landing glideslope constraint (blue cone in Figure 1), which forces the spacecraft to land inside the landing radius r l . The glideslope relaxation constant is β ≜ 1 -r l ∥ r f ∥ atan θ gs .

The set of allowed states is the intersection of the zerosuperlevel sets of the state constraints, which is

<!-- formula-not-decoded -->

Additionally, the input constraints are

<!-- formula-not-decoded -->

which implies that the set of admissible controls is

<!-- formula-not-decoded -->

Our objective is to design a full-state feedback control, such that for all initial conditions x 0 ∈ Ψ , the trajectory ( x, u ) satisfies the following objectives:

- (O1) The spacecraft (1)-(3) lands at time t l ∈ [0 , ∞ ) .

We develop a control using a reference trajectory, which is generated by an offline trajectory generation algorithm [4]. Let x r : [0 , ∞ ) → R 7 and u r : [0 , ∞ ) → R 3 be a known reference state and control that satisfies the following conditions:

<!-- formula-not-decoded -->

- (A2) ( x, u ) = ( x r , u r ) satisfies (5) on [0 , ∞ ) with w = 0 .
- (A4) u r is continuously differentiable on [0 , ∞ ) .
- (A3) For all t ∈ [0 , ∞ ) , x r ( t ) ∈ Ψ and u r ( t ) ∈ Φ .

The control strategy presented in this article is structured as a three-stage framework (see Figure 2). In the first stage, an EHGO is employed to estimate the disturbances acting on the system. In the second stage, a feedback linearizing controller is synthesized to ensure tracking of the reference trajectory while compensating for the estimated disturbance. In the final stage, a minimum intervention control that satisfies both state and input constraints is designed using CBFs.

## III. FEEDBACK-LINEARIZING AND DISTURBANCE-CANCELING CONTROL

This section presents the control developed to meet (O1).

## A. EHGO for Gravitational Uncertainty Estimation

To compensate for gravitational uncertainty, we estimate w ( x ( t )) = U ′ ∆ ( r ( t )) ⊤ using an EHGO. We adopt the approach in [18] and extend this method to a nonlinear system.

Let τ &gt; 0 be the observer gain, and consider the auxiliary variable ν ( t ) → R 3 that satisfies where ˆ w ( v, ν ) ≜ τv -ν is the disturbance estimate and ν (0) = τv 0 . Define the estimation error

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

The next result provides a result on the convergence of the estimation error to a compact set whose size is inversely proportional to the observer gain. The proof is omitted for space.

Fact 1. Assume (A1) is satisfied. Then, ˆ w and ˙ w are bounded. Furthermore, ∥ ˜ w ( x ( t ) , ν ( t )) ∥→ [0 , η τ ] exponentially as t →∞ , where η ≜ sup t ≥ 0 ∥ ˙ w ( x ( t )) ∥ .

## B. Feedback Linearizing Tracking Control

We now proceed to design a full-state feedback control that tracks the reference trajectory ( x r , u u ) and cancels the disturbance using the disturbance estimate ˆ w . Let k p &gt; 0 , k v &gt; 0 and consider the desired control

<!-- formula-not-decoded -->

The following fact provides stability results of the system (5) using the control (13) by leveraging on the estimated disturbance (11) and its convergence results from fact 1. The proof is omitted for space.

Fact 2. Consider (5), where u = u d and (A1) is satisfied. Define e ( t ) ≜ r ( t ) -r r ( t ) . Then, there exists η &gt; 0 such that

∥ ∥ Fact 2 implies that for a sufficiently large τ , (O1) is satisfied asymptotically.

<!-- formula-not-decoded -->

## IV. CONTROL BARRIER FUNCTIONS FOR STATE AND INPUT CONSTRAINTS

The desired control u d is formulated to achieve both disturbance rejection and accurate tracking of the reference trajectory. However, this control law does not necessarily ensure that (O2) is achieved. To address this safety requirement, we incorporate a CBF-based optimization framework.

## A. State and Input Constraints

We formulate candidate CBFs associated with the constraint functions (6), (7), and (9). Each constraint function is scaled by a constant k vel , k gs , k u &gt; 0 and, where appropriate, modified by squaring terms. The purpose of these modifications is to normalize the outputs of the functions so that their

&lt;latexi sh

1\_b

64="/wQTZn

7zFr

NW5

pEPKJ

AU

&gt;

C

X

c

V

d

9

H

yD

j

G0v

q

oS

M

I

g

k

u

Y

8R

+

L

f

3

m

O

B

2

x

u

&lt;latexi sh

1\_b

64="r0T2B

P/5

qZj k+

mp

IHzW

&gt;A

CF3

c

VDJSgN

EO

9y

M

UQvX

Y

d

7

no

L

w

8

u

K

G

f

R

&lt;latexi sh

1\_b

64="VTW

mUp+

P

LkrG

Q

Yy8AnRE

&gt;

C

c

ZFf

9

w

M

dj

7

S

K

qg

z

J

0

3

2

vo

5

X

I

H

B

N

u

D

O

/

&lt;latexi sh

1\_b

64="

BZLgO

u

8U

5

XPGnj r2

7

&gt;A

DWH

c

VJN

9

E

0k

3

R

y

I

K

q

F

S

o

z

f

d

v

m/

+

QT

p

w

C

M

Y

&lt;latexi sh

1\_b

64="Kfkqdc3DQCEIg9

OpW

GS

w

&gt;A

Pn

VBN

X

75T

H

o

2

0

z

U

u

RJ

r

/

L

+

y

j

Z

8

v

M

F

Y

m

&lt;latexi sh

1\_b

64="/wQTZn

7zFr

NW5

pEPKJ

AU

&gt;

C

X

c

V

d

9

H

yD

j

G0v

q

oS

M

I

g

k

u

Y

8R

+

L

f

3

m

O

B

2

&lt;latexi sh

1\_b

64="VTW

mUp+

P

LkrG

Q

Yy8AnRE

&gt;

C

c

ZFf

9

w

M

dj

7

S

K

qg

z

J

0

3

2

vo

5

X

I

H

B

N

u

D

O

/

&lt;latexi sh

1\_b

64="JPF9wrXfD23US

pA

Iv8T

yE

&gt;

C

c

V

gNB

O

W

z

q

MQ

H

L

m

Z

0

Rno

G

+

j

/

5

Y

K

d

k

7

u

&lt;latexi sh

1\_b

64="uE5cg

w

8

0d3fPC7TWyoFK

&gt;A

n

VDLS

N

J

U

2vq

m

H

Z

O

G

k

Q

jr

Y

+

z

p

X

/

M

R

9

I

B

&lt;latexi sh

1\_b

64="/wQTZn

7zFr

NW5

pEPKJ

AU

&gt;

C

X

c

V

d

9

H

yD

j

G0v

q

oS

M

I

g

k

u

Y

8R

+

L

f

3

m

O

B

2

&lt;latexi sh

1\_b

64="

QJY7

V

M5

KO

SrcR8uWG

CIE

&gt;A

NX

B

9

F0

Zq

T

m

o

P

w

g

+z

H

k

/

d

fv

U

p

3

2

L

n

Dy

j

&lt;latexi sh

1\_b

64="

FSH

VZP9uqcf+B

E

k

XYUC8

&gt;A

DL

gM

3

2v

d

W

G

p

oR

n

J

Q

mT

5K

0

/

j

r

w

N

y

7

I

z

O

&lt;latexi sh

1\_b

64="m9R/

3qYM

d

+

IU

c

BuG

O

A

&gt;

CD

Z

SwN

E

z

T

j

o

r

Qy

Wg

F8L

p

7

2

P

K

f

HV

k

X

5

0

v

J

n

&lt;latexi sh

1\_b

64="/wQTZn

7zFr

NW5

pEPKJ

AU

&gt;

C

X

c

V

d

9

H

yD

j

G0v

q

oS

M

I

g

k

u

Y

8R

+

L

f

3

m

O

B

2

u

Fig. 2. Control architecture consisting of an extended high-gain disturbance observer, a feedback-linearizing and disturbance-canceling control, and a control barrier function-based controller to ensure optimality and safety during trajectory execution.

<!-- image -->

magnitudes are comparable, and to ensure smoothness by eliminating potential sources of non-differentiability. We define

<!-- formula-not-decoded -->

h 2 , 0 ( x ) ≜ k gs ( ˆ e ⊤ s ( r -βr f ) -∥ r -βr f ∥ cos θ gs ) , (15) h 3 , 0 ( u ) ≜ k u ( T 2 max -∥ u ∥ 2 ) , (16) h 4 , 0 ( u ) ≜ k u ( ∥ u ∥ 2 -T 2 min ) , (17) and we define the zero-superlevel sets

<!-- formula-not-decoded -->

These sets coincide with the original admissible input and state sets in (8) and (10) (i.e., ˜ Ψ = Ψ , ˜ Φ = Φ ).

Next, we define

<!-- formula-not-decoded -->

which is the set of state and inputs that satisfy the constraints. Note that if ( x ( t ) , u ( t )) ∈ S s for all t ∈ [0 , ∞ ) , then (O2) is satisfied.

## B. Control Dynamics for Input Constraints and Soft-minimum Relaxed CBF

Since (16) and (17) depend explicitly on the control u , they are not valid candidate CBFs. We adopt the method in [19], to transform these input constraints into controller-state constraints by introducing control dynamics. First, let the control input u evolve according to the first-order dynamics

<!-- formula-not-decoded -->

where a &gt; 0 , u (0) = u 0 and ζ ( t ) ∈ R 3 is the surrogate control, which is the control input to (21). Next, consider the desired surrogate control ζ d : R 7 × R 3 × [0 , ∞ ) × [0 , ∞ ) × R 3 → R 3 defined by

<!-- formula-not-decoded -->

where σ &gt; 0 and the time derivative of the desired control is given by

<!-- formula-not-decoded -->

Proposition 8 in [19] shows that if ζ = ζ d , then u converges exponentially to u d . This result suggests that ζ d is the desired input to the control dynamics (21) that reproduces the desired control (13).

To compute ˙ u d , we use (11) to obtain ˙ ν . Next, the reference state dynamics are given by

<!-- formula-not-decoded -->

Since ˙ x is not available, we compute (23) with the approximation

<!-- formula-not-decoded -->

Furthermore, (A4) implies that ˙ u r exists and is continuous. In practice, ˙ u d can be computed numerically.

The cascade of (5) and (21) is

<!-- formula-not-decoded -->

where

<!-- formula-not-decoded -->

Note that the control input u is a state of the augmented system (24). Consequently, the input constraints are now state constraints of the augmented system. These constraints have relative degree one with respect to the input ζ and are valid candidate CBFs. However, introducing control dynamics increases the relative degree of (14) and (15), which have relative degrees two and three with respect to ζ , respectively. We construct higher-order CBFs [20]. First, let α 1 : R → R be a two times differentiable extended classK function, and consider h 1 , 1 : R 7 × R 3 → R defined by

<!-- formula-not-decoded -->

Next, let β 1 : R → R , β 2 : R → R be extended classK functions such that β 1 and β 2 are three and two times

ζ

ζ

d

ν

differentiable respectively. Then, consider h 2 , 1 : R 7 → R , h 2 , 2 : R 7 × R 3 → R defined by

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

Note that (25) and (27) have relative degree one with respect to the input ζ . Next, define the zero-superlevel set

<!-- formula-not-decoded -->

and

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

Let ¯ S be the intersection of the safe set (20), the zerosuperlevel sets of the intermediate higher order functions (28) and the zero-superlevel set of the candidate CBFs (29), that is,

Note that ¯ S ⊂ S s . Moreover, if ( x 0 , u 0 ) ∈ ¯ S and for all t ∈ [0 , ∞ ) , ( x ( t ) , u ( t )) ∈ ¯ H , then for all t ∈ [0 , ∞ ) , ( x ( t ) , u ( t )) ∈ ¯ S ⊂ S s [20, Proposition 1]. This fact motivates us to consider a candidate CBF whose zero-superlevel set is a subset of ¯ H .

<!-- formula-not-decoded -->

Let ρ &gt; 0 and consider h : R 7 × R 3 → R given by

The zero-superlevel set of h is

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

Thus, H ⊂ ¯ H and as ρ →∞ , H → ¯ H [21, Proposition 2]. Note that H is not necessarily a subset of S s or ¯ S . Thus, we define and since ¯ S ⊂ S s , it follows that S ⊂ S s .

Next, define

<!-- formula-not-decoded -->

which is the set of augmented states ( x, u ) ∈ bd H where the uncontrolled flow of (24) leaves H . We assume that ζ directly influences the time derivative of h on B , as formalized in the next assumption:

<!-- formula-not-decoded -->

̸

The following result is from [21, Proposition 8], and demonstrates that h is a relaxed-CBF (R-CBF).

Proposition 1. Assume (A5) is satisfied. Then, h is an R-CBF for (24) on H .

Since h is an R-CBF on H , it is possible to construct a control such that H is forward invariant with respect to the closed-loop dynamics. This is useful since the next result shows that forward invariance of H implies forward invariance of S , which is a subset of S s . The proof is in [21, Prop. 9].

Proposition 2 shows that if h remains nonnegative along the solution trajectory of (24), then the state and input remains in a subset of S s . This motivates design of a control ζ that makes H forward invariant.

Proposition 2. Consider (24), where ( x 0 , u 0 ) ∈ S . Assume that for all t ∈ [0 , ∞ ) , ( x ( t ) , u ( t )) ∈ H . Then, for all t ∈ [0 , ∞ ) , ( x ( t ) , u ( t )) ∈ S ⊂ S s .

## C. Optimal and Safe Control

We use the R-CBF (31) to design ζ that ensures the statecontrol pair ( x, u ) stays in the safe set S ⊂ S s . To this end, we formulate an optimization that enforces forward invariance of H while minimizing the distance of ζ from ζ d . To preserve feasibility of the optimization problem, we introduce a slack variable κ . Consider the cost

<!-- formula-not-decoded -->

Next, to ensure ( x, u ) ∈ S ⊂ S s , let α : R → R be a locally Lipschitz non decreasing function such that α (0) = 0 , and consider the constraint b : R 7 × R 3 × R 3 × R → R , defined as

<!-- formula-not-decoded -->

For each ( x, u ) , the minimizer of (35) subject to b ( x, u, ν, ζ, κ ) ≥ 0 can be derived from the first-order necessary conditions for optimality [19]. The minimizer of (35) subject to b ( x, u, ζ, κ ) ≥ 0 is given by

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where

<!-- formula-not-decoded -->

The next result establishes that ( ζ ∗ , κ ∗ ) minimizes the cost function J ( x, u, ζ d , ζ, κ ) over all ( ζ, κ ) satisfying the constraint b ( x, u, ζ, κ ) ≥ 0 . The proof is in [19, Theorem 1].

̸

Theorem 1. Let ( x, u ) ∈ R 7 × R 3 , and let ζ d ∈ R 3 . Next, let ( ζ, κ ) ∈ R 3 × R such that b ( x, u, ζ d , ζ, κ ) ≥ 0 and ( ζ, κ ) = ( ζ ∗ , κ ∗ ) . Then,

<!-- formula-not-decoded -->

The following theorem guarantees constraint satisfaction by showing that the control input ( ζ ∗ , κ ∗ ) renders the set S forward invariant. The proof is in [19, Corollary 3].

Theorem 2. Consider the system (5) with the control (21), where ζ = ζ ∗ as defined in (37)-(40). Assume that

(A5) holds, ˆ w = w and h ′ is locally Lipschitz. Then, for all ( x 0 , u 0 ) ∈ S and for all t ∈ [0 , ∞ ) , the trajectory satisfies ( x ( t ) , u ( t )) ∈ S ⊂ S s .

Together, theorem 1 and theorem 2 show that the control (21) and (37)-(40) with ζ = ζ ∗ ensures (O2) while producing a control u that approximates u d , which is designed to achieve (O1).

## V. SIMULATION RESULTS

We present numerical simulations to verify the performance of the proposed control. The asteroids considered in the following examples are modeled as an ellipsoid or a composition of multiple ellipsoids. The gravitational field of the asteroids is modeled using spherical harmonics [2]. Each ellipsoid is characterized by a constant density ρ &gt; 0 and semi-major axes 0 &lt; c ≤ b ≤ a . The known gravitational field model U m is the point-mass Newtonian gravitational model. We consider a spacecraft with a wet mass of m w = 700 kg and a dry mass m d = 500 kg. The thrusters have a specific impulse of I sp = 225 s, and the thrust magnitude is bounded within T min = 5 N and T max = 20 N.

The reference trajectories ( x r , u r ) are obtained by solving a fuel-optimal control problem, which included the position constraint (7) and the input constraints (9) as hard constraints.

We implement the control u which satisfies (21), where the estimated gravitational perturbation is (11), the desired control is given by (13) and the surrogate control ζ is given by (37)-(40). For sample-data implementation, the control is updated at 25 Hz. The performance parameters for landing are r l = 0 . 6 m, δ = 0 . 5 m, and ε = 0 . 3 m s .

The constraint function (7) uses θ gs = 45 ◦ , while (6) uses v min = √ ∥ v f ∥ . The disturbance observer gain is set to τ = 10 , and the desired control gains are k p = 0 . 002 and k v = 0 . 09 . The input dynamics parameters are a = 3 and σ = 5 . The classK functions for the higher-order CBFs are defined as α 1 ( h ) = h and β 1 ( h ) = β 2 ( h ) = α ( h ) = 10 h . The composite CBF in (31) uses ρ = 40 , and the penalty weight for the slack variable is set to γ = 10 10 . The state constraints (25) and (27) are evaluated with w = 0 and the constraint (40) is evaluated with ˆ w = 0 . The scaling constants for the candidate-CBFs are

<!-- formula-not-decoded -->

For both scenarios, executing the trajectory with u = u r results in position constraint violations (i.e. no landing); using u = u d alone results in input constraint violations; and u equal to u d with saturation still results in position constraint violations. These outcomes expose the limitations of direct trajectory execution and simple feedback control; the following examples illustrate how the proposed control overcomes them.

## A. Ellipsoidal Asteroid with uniform density

We consider an ellipsoidal asteroid with semi-axes a = 1000 m, b = c = 400 m. Its density is ρ = 1380 kg m 3 , typical of C-type asteroids. To account for parametric uncertainty, the model mass is reduced by 25%. The asteroid rotates about its principal axis with the largest moment of inertia with a synodic period p sp = 4 h. The spacecraft's initial and desired states are: r 0 = [ 1927 . 2 -374 . 6 -954 ] ⊤ , r f = [ 400 0 0 ] ⊤ m, v 0 = [ -1 . 64 -3 . 02 -3 . 64 ] ⊤ and v f = [ 0 0 . 174 0 ] ⊤ m s .

Landing is achieved at t l = 839 . 88 s, and at the time of landing we get ∥ r ( t l ) -r f ∥ = 0 . 4168 m, ˆ e ⊤ ( r ( t l ) -r f ) = 0 . 0047 m and ∥ v ( t l ) -v f ∥ = 0 . 278 m s . Figure 3 shows the trajectory of the spacecraft during the successful execution of the maneuver. The EHGO effectively estimates the disturbance arising from gravitational uncertainty. As established in fact 1, the disturbance estimation error converges to a set, as illustrated in fig. 4. The magnitude of the normalized error varies as the spacecraft approaches the asteroid, primarily due to the increasing influence of higher-order gravitational effects.

Fig. 3. Spacecraft trajectory during the landing maneuver on the ellipsoidal asteroid, where landing is achieved.

<!-- image -->

Fig. 4. Normalized disturbance estimate error for Ellipsoidal asteroid case. The error exponentially converges to a set whose size changes as the spacecraft approaches the asteroid.

<!-- image -->

Figure 5 shows that all state and input constraints remain positive through out the execution of the maneuver. As shown in Figure 6, the controller actively modifies the desired control input to ensure constraint satisfaction during the last 120 seconds of the maneuver, the period of time in which other control approaches violated the position constraint (15).

Fig. 5. State and input constraints remain positive, ensuring safe execution of the soft-landing maneuver.

<!-- image -->

Fig. 6. Desired input u d and applied control u during the maneuver. The controller modifies the input in real time to ensure constraint satisfaction.

<!-- image -->

B. Irregularly Shaped Asteroid with noon-uniform density distribution

We consider an irregularly shaped asteroid with nonuniform density, modeled as the union of two ellipsoids with uniform densities. The primary has semi-axes a = 1000 m , b = c = 400 m and density ρ 1 = 1460 kg m 3 , while the secondary has a = 800 m , b = c = 400 m and ρ 2 = 1380 kg m 3 . The asteroid rotates about its principal axis with the largest moment of inertia with a synodic period p sp = 4 h and total mass M = 1 . 7184 × 10 12 kg. To model parametric uncertainty, the mass is reduced by 25%. The spacecraft's initial and desired states are: r 0 = [1927 . 2 , -374 . 6 , -954] ⊤ , r f = [600 , 0 , -253 . 5] ⊤ m, v 0 = [ -1 . 64 , -3 . 02 , -3 . 64] ⊤ and v f = [0 , 0 . 2618 , 0] ⊤ m s .

Figure 7 shows the landing trajectory of the spacecraft using the proposed control. Landing is achieved at 628 . 2 s, with performance errors ∥ r ( t l ) -r f ∥ = 0 . 5045 m, ˆ e ⊤ ( r ( t l ) -r f ) = 0 . 4669 m and ∥ v ( t l ) -v f ∥ = 0 . 0096 m s . The disturbance estimator accurately reconstructs the gravitational perturbation via the EHGO, as illustrated in Figure 8, the normalized estimation error remains small thouroughut the enirety of the maneuver, although it is never zero as implied by fact 1.

Fig. 7. Spacecraft trajectory during the landing maneuver on the irregularly shaped, non-uniform density asteroid. Landing is successfully achieved.

<!-- image -->

Fig. 8. Normalized disturbance estimation error. The EHGO accurately reconstructs the disturbance, the error remains small but nonzero, consistent with fact 1.

<!-- image -->

Figure 9 shows that the proposed CBF-based controller avoids all state and input constraint violations. As seen in Figure 10, it adjusts the control input during the final 28 seconds to satisfy state constraints and applies smaller modifications along the trajectory to satisfy actuator constraints.

## VI. CONCLUSIONS

This paper proposed a control for safe soft-landing on small celestial bodies, integrating a nonlinear EHGO for

Fig. 9. State and input constraints remain positive throughout the maneuver, ensuring safe execution of the landing.

<!-- image -->

Fig. 10. Desired input u d and applied control u during the maneuver. The controller modifies the input in real time to maintain constraint satisfaction.

<!-- image -->

disturbance estimation, a feedback-linearizing disturbancecanceling controller for trajectory tracking, and a CBFbased layer to enforce state and input constraints. Simulation results on both ellipsoidal and irregular asteroids demonstrated that the control achieves disturbance estimation and compensation, guarantees constraint satisfaction, and enables successful landings even under significant gravitational uncertainty-conditions under which direct trajectory execution or simple feedback control fail. The computational efficiency of the proposed method make it well-suited for autonomous onboard implementation. Future work will focus on extending the framework to include coupled attitude and position control, over-actuated spacecraft, and more general proximity and rendezvous operations.

## REFERENCES

[1] R. Bull, R. Mitch, J. Atchison, J. McMahon, A. Rivkin, and E. Mazarico, 'Optical gravimetry mass measurement performance for small body

- flyby missions,' Planetary and Space Science , vol. 205, p. 105289, 2021.
- [2] D. J. Scheeres, Orbital Motion in Strongly Perturbed Environments: Applications to Asteroid, Comet and Planetary Satellite Orbiters , 1st ed., ser. Springer Praxis Books. Berlin, Heidelberg: Springer-Verlag Berlin Heidelberg, 2012.
- [3] P. Pe˜ narroya and R. Paoli, 'Orbit propagation around small bodies using spherical harmonic coefficients obtained from polyhedron shape models,' in Proceedings of IAU Symposium No. 364: Multi-scale (time and mass) dynamics of space objects , A. Celletti, C. Gales , , C. Beaug´ e, and A. Lemaitre, Eds. Cambridge University Press, 2022.
- [4] D. Malyuta, Y. Yu, P. Elango, and B. Ac ¸ıkmes ¸e, 'Advances in trajectory optimization for space vehicle control,' Annual Reviews in Control , vol. 52, pp. 282-315, 2021.
- [5] P. Simpl´ ıcio, A. Marcos, E. Joffre, M. Zamaro, and N. Silva, 'Synthesis and analysis of robust control compensators for Space descent &amp; landing,' International Journal of Robust and Nonlinear Control , vol. 28, no. 13, pp. 3871-3892, Sep. 2018.
- [6] M. Tiwari, R. Prazenica, and T. Henderson, 'Direct adaptive control of spacecraft near asteroids,' Acta Astronautica , vol. 202, pp. 197-213, Jan. 2023.
- [7] W. Dunham, C. Petersen, and I. Kolmanovsky, 'Constrained control for soft landing on an asteroid with gravity model uncertainty,' in 2016 American Control Conference (ACC) . Boston, MA, USA: IEEE, Jul. 2016, pp. 5842-5847.
- [8] J. C. Sanchez, F. Gavilan, and R. Vazquez, 'A Predictive Guidance Algorithm for Autonomous Asteroid Soft Landing,' IFAC-PapersOnLine , vol. 51, no. 12, pp. 6-11, 2018.
- [9] M. Tiwari, E. Coyle, and R. J. Prazenica, 'Direct-Adaptive Nonlinear MPC for Spacecraft Near Asteroids,' Aerospace , vol. 9, no. 3, p. 159, Mar. 2022.
- [10] S. Van Leeuwen, T. Skibik, M. Nicotra, I. Kolmanovsky, and D. LiaoMcPherson, 'A Nonlinear Predictive Control Strategy for Landing on an Asteroid,' in 2022 American Control Conference (ACC) . Atlanta, GA, USA: IEEE, Jun. 2022, pp. 443-449.
- [11] A. D. Ames, S. Coogan, M. Egerstedt, G. Notomista, K. Sreenath, and P. Tabuada, 'Control Barrier Functions: Theory and Applications,' in 2019 18th European Control Conference (ECC) . Naples, Italy: IEEE, Jun. 2019, pp. 3420-3431.
- [12] J. Breeden and D. Panagou, 'Robust Control Barrier Functions under high relative degree and input constraints for satellite trajectories,' Automatica , vol. 155, p. 111109, Sep. 2023.
- [13] P. Ong, G. Bahati, and A. D. Ames, 'Stability and Safety through Event-Triggered Intermittent Control with Application to Spacecraft Orbit Stabilization,' in 2022 IEEE 61st Conference on Decision and Control (CDC) . Cancun, Mexico: IEEE, Dec. 2022, pp. 453-460.
- [14] P. Ong and A. D. Ames, 'Intermittent Safety Filters for Event-Triggered Safety Maneuvers with Application to Satellite Orbit Transfers,' in 2023 62nd IEEE Conference on Decision and Control (CDC) . Singapore, Singapore: IEEE, Dec. 2023, pp. 870-877.
- [15] J. Breeden and D. Panagou, 'Guaranteed Safe Spacecraft Docking With Control Barrier Functions,' IEEE Control Systems Letters , vol. 6, pp. 2000-2005, 2022.
- [16] --, 'Autonomous Spacecraft Attitude Reorientation Using Robust Sampled-Data Control Barrier Functions,' Journal of Guidance, Control, and Dynamics , vol. 46, no. 10, pp. 1874-1891, Oct. 2023.
- [17] S. S. Kamat, T. M. Seigler, and J. B. Hoagg, 'Electromagnetic Formation Flying with State and Input Constraints Using Alternating Magnetic Field Forces,' in 2025 American Control Conference (ACC) . Denver, CO, USA: IEEE, Jul. 2025, pp. 1701-1706.
- [18] T. Poloni, U. Kalabic, K. McDonough, and I. Kolmanovsky, 'Disturbance canceling control based on simple input observers with constraint enforcement for aerospace applications,' in 2014 IEEE Conference on Control Applications (CCA) . Juan Les Antibes, France: IEEE, Oct. 2014, pp. 158-165.
- [19] P. Rabiee and J. B. Hoagg, 'A Closed-Form Control for Safety Under Input Constraints Using a Composition of Control Barrier Functions,' 2024. [Online]. Available: https://arxiv.org/abs/2406.16874
- [20] X. Tan, W. Shaw Cortez, and D. V. Dimarogonas, 'High-Order Barrier Functions: Robustness, Safety, and Performance-Critical Control,' IEEE Transactions on Automatic Control , vol. 67, no. 6, pp. 3021-3028, Jun. 2022.
- [21] A. Safari and J. B. Hoagg, 'Time-Varying Soft-Maximum Barrier Functions for Safety in Unmapped and Dynamic Environments,' IEEE Transactions on Control Systems Technology , pp. 1-16, 2025.