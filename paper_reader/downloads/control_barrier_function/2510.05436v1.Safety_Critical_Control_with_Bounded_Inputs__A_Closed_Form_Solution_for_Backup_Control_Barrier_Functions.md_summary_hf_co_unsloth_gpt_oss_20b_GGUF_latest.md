**Title & Citation**  
*Safety‑Critical Control with Bounded Inputs: A Closed‑Form Solution for Backup Control Barrier Functions*  
David E. J. van Wijk, E. Daş, T. G. Molnar, A. D. Ames, J. W. Burdick – presented in 2025 IEEE Control Systems Letters (full reference list in §VI).

---

### Abstract  
The paper tackles the problem of ensuring safety for nonlinear control‑affine systems that operate with hard input bounds.  Backup control barrier functions (bCBFs) offer feasibility guarantees but require solving a high‑dimensional quadratic program (QP) and numerically integrating the sensitivities of the backup flow, which can be computationally prohibitive for safety‑critical aerospace platforms.  The authors propose an *optimally interpolated* (OI) controller that interpolates between a nominal controller and a pre‑verified backup controller by solving a one‑dimensional quadratic program for a blending weight, μ.  They prove that this QP has a closed‑form solution, obviating the need to run a QP solver online and reducing the number of ODEs that must be integrated.  Simulations on a double‑integrator and a nonlinear fixed‑wing aircraft (geofencing example) demonstrate that the OI controller eliminates the oscillatory behaviour seen with simple function‑based blending while retaining the safety guarantees of bCBFs.

---

### Introduction & Motivation  
- Safety‑critical control is essential in autonomous systems; safety constraints are often represented by *control barrier functions* (CBFs).  
- Conventional CBFs need the safety constraint (2) to be satisfied for all admissible inputs; with bounded inputs this feasibility can fail.  
- *Backup CBFs* (bCBFs) overcome this by explicitly constructing a *controlled invariant* backup set, \(C_B \subset C_S\), and a backup controller \(k_b\) that keeps the system within this set.  Safety then follows from the feasibility of a bCBF‑QP that enforces (10).  
- The drawback: solving the bCBF‑QP is expensive—each constraint requires evaluating the *sensitivity* \(\Phi_b(\tau,x)\), which involves integrating \(n + n^2\) ODEs.  This burden is problematic for aerospace vehicles which already have tight online computational budgets.  
- A previous workaround (“safe blending”) mixes the nominal controller \(k_p\) and the backup controller linearly via a hand‑tuned blending function \(\mu\).  While it removes the optimization and sensitivity cost, it can exhibit undesirable chattering when \(k_p\) and \(k_b\) conflict.  
- The authors therefore locate a *middle ground*: they retain the computational tractability of blending while selecting μ *optimally* to satisfy all safety constraints.  This is the core contribution of the paper.

---

### Methods / Approach  

**1. System Model**  
The system is a nonlinear control‑affine model  
\[
\dot{x}=f(x)+g(x)u,\quad x\in\mathbb{R}^n,\; u\in U\subseteq\mathbb{R}^m
\tag{1}
\]  
with \(U\) a convex polytope.

**2. Safety Set**  
Safety is encoded by a continuously differentiable safety function \(h:\mathbb{R}^n\to\mathbb{R}\) with non‑zero gradient on \(\partial C_S\):  
\[
C_S :=\{x\in\mathbb{R}^n: h(x)\ge 0\}.
\tag{2}
\]  

**3. Backup Set and Backup Dynamics**  
A *backup set* \(C_B\) is defined by a backup CBF \(h_b\) (analogous to \(h\)) and a backup controller \(k_b\).  The backup dynamics are  
\[
\dot{x}=f(x)+g(x)k_b(x)\equiv f_{\!cl}(x).
\tag{6}
\]  

A *controlled invariant* backup set \(C_B\subseteq C_S\) is a set for which
\[
f_{\!cl}\cdot h_b(x)\ge0 \quad\forall x\in C_B.
\tag{8}
\]  

**4. Backward Invariance via Forward Integration**  
Using the backup flow \(\varphi_b(\tau,x)\) (the solution of (6) with initial value \(x\) at time \(0\)), the *controlled invariant* set within \(C_S\) is  
\[
C_I:=\{x\in C_S:\varphi_b(\tau,x)\in C_S\;\forall\tau\in[0,T]\}.
\tag{7}
\]  

Thus, if at time \(t\) the state is in \(C_I\), forward integration under \(k_b\) will keep it in \(C_S\).

**5. Classical bCBF‑QP**  
Seeking the *least invasive* safe controller \(k_{\!safe}\) leads to the quadratic program  
\[
\begin{aligned}
\min_{u}\quad & \|u\|^2\\
\text{s.t.}\quad & a(\tau,x)+b(\tau,x)u\ge0,\\
&\text{for all }\tau\in[0,T],
\end{aligned}
\tag{9}
\]  
with \(a,b\) defined from \(h\) and \(h_b\).  The constraints involve \(\Phi_b(\tau,x)\), so numerical integration of \(n+n^2\) ODEs is required.

**6. Function‑Based Blending**  
A preliminary compositional scheme writes  
\[
k_m(x)=k_p(x)+\mu(x)(k_b(x)-k_p(x))
\tag{13}
\]  
where the blending weight \(\mu\) is chosen by a hand‑tuned function \(\Lambda\bigl( \tfrac{h_I(x)}{\|h_I\|}\bigr)\).  This scheme needs no optimization or sensitivity computation but can oscillate when \(k_p\) and \(k_b\) conflict (shown in a double‑integrator example).

**7. Optimally Interpolated (OI) Controller**  
The authors propose *solving* for an optimal \(\mu(x)\) that satisfies the same constraints as the bCBF‑QP but with the simplified controller in (13).  The optimisation problem reads  
\[
\begin{aligned}
\min_{\mu}\quad & \mu^2\\
\text{s.t.}\quad & a(\tau,x)+b(\tau,x)\mu\ge0,\\
&\text{for all }\tau\in[0,T],
\end{aligned}
\tag{17}
\]  
with \(a(\tau,x)=a^+(x)+b^+(x)k_p(x)+b^+(x)(k_b(x)-k_p(x))\) and similar for \(b\).  Under discretisation there are 3 basic constraints, one term for each time step and for \(\mu\in[0,1]\).

**Closed‑Form Solution**  
Lemma 3 proves feasibility.  Theorem 4 gives the closed‑form solution of the discretised problem (20):  
\[
\mu^\star(x)=
\max_{i\in I^+}\!\!\Bigl(-\frac{a_i(x)}{b_i(x)}\Bigr)\wedge 1,
\tag{21}
\]  
where \(I^+=\{i\;|\;b_i(x)>0\}\).  Passing to the continuous limit as \(N\to\infty\) yields  
\[
\mu^\star(x)=\min\!\Bigl(1,\;\max_{\tau\in[0,T]}\!-\frac{a(\tau,x)}{b(\tau,x)}\Bigr).
\tag{26}
\]  
Since \(a,b\) are linear in \(u\), this is a simple analytic expression depending only on the state and the two controllers.  This solution is further shown to satisfy the KKT conditions (22)–(24).

**Computational Savings**  
Unlike the full bCBF‑QP, the OI approach avoids computing the full sensitivity matrix \(\Phi_b(\tau,x)\).  Instead, directional components are obtained by integrating the initial‑value problems  

\[
\dot{q}_p(\tau,x)
=\!\bigl[\!F_{cl}(\varphi_b(\tau,x))\!\bigr]\, q_p(\tau,x),
\quad
\dot{q}_b(\tau,x)
=F_{cl}(\varphi_b(\tau,x))\, q_b(\tau,x),
\tag{29}
\]  

which require only \(3n\) ODEs (vs \(n+n^2\)).  The overall online requirement is thus negligible for aerospace platforms.

---

### Experiments / Data / Results  

| Example | System | Controllers Compared | Key Observations |
|--------|--------|----------------------|------------------|
| **1** | Double integrator (eqn (16)), \(x=(x_1,x_2)\), \(U=[-1,1]\) | bCBF‑QP, plain blending (eqn (13) with Λ from (14–15)), OI‑QP | OI and bCBF‑QP behave identically (single input).  Blending shows oscillations at the safe boundary (Figure 2, top).  OI guarantees smoothness. |
| **2** | Nonlinear fixed‑wing aircraft (eqn (30)), kinematic equations with bounded roll rate \(u_1\in[-\pi/2,\pi/2]\), load factor \(u_2\in[-1,4]\) | bCBF‑QP (black), blended controller (pink), OI‑QP (green) | All stay in the geofence (blue).  Blended controller exhibits chattering near the boundary (roll rate swings, Figure 3 bottom right).  OI smoothly modulates between \(k_p\) and \(k_b\) without oscillation (Figure 3 top left/right).  OI off‑loads the high‑dim QP and reduces ODE integration from 72 to 24. |

**Figures**

- **Fig. 1** – Overview of the OI framework on a fixed‑wing geofencing task.  
- **Fig. 2** – Double integrator plots: top of each subplot shows the trajectory, top right shows controller input vs time, bottom shows input magnitude.  The blended (pink) shows oscillatory input near the boundary, contrast with OI (green) and bCBF‑QP (black).  
- **Fig. 3** – Fixed‑wing aircraft simulation: top-left art the nominal and backup states, top-right controller traces, top-right (b) roll rate command oscillations for blended, bottom-right safety boundary.  OI keeps the aircraft inside the safe set and avoids oscillation.

---

### Discussion & Analysis  

- **Safety Guarantee**: By construction, the μ chosen by (17) satisfies all constraints that the bCBF‑QP enforces; thus, safety is preserved.  
- **Optimality**: μ is chosen to minimize misuse of the backup controller, thereby keeping the controller as close as possible to the nominal \(k_p\).  This yields better performance than hand‑tuned blending.  
- **Computational Advantages**: Closed‑form μ eliminates online QP solving; directional sensitivity integration reduces ODE count to \(3n\).  Chain‑able with fast embedded solvers.  
- **Limitation**: The controller remains a *scalar* interpolation between two vector controls; thus, it cannot exploit multi‑dimensional blending for high‑dimensional multi‑constraint sets.  The authors note a multi‑dimensional extension is possible but lacks closed‑form.  
- **Oscillation Avoidance**: Empirically, OI removes the oscillations of the naive blending scheme that occur when the nominal and backup controls oppose each other.  This is proved by showing the KKT conditions for (20) are satisfied by (21) – hence, the optimizer selects the *steering* μ that keeps the safety constraint active only when needed.  
- **Robustness to Discretisation**: The proof of feasibility for the discretised QP (20) implies that even with finite time steps the OI approach will provide safe controls; simulations show coarse sampling (N ≈ 10) suffices.  

---

### Conclusions  

- The paper presents a new safety‑critical controller synthesis mechanism for systems with bounded inputs.  
- The *optimally interpolated* (OI) controller interpolates between a verified backup controller and a nominal controller with a *closed‑form* solution for the blending weight.  
- The OI formulation preserves safety and input‑boundedness proofs while avoiding the high computational burden of bCBFs.  
- Simulations on a double integrator and a nonlinear fixed‑wing aircraft demonstrate that the OI controller eliminates the undesirable oscillations seen with function‑based blending and achieves similar safety to the bCBF‑QP.  
- Future work will target deploying OI‑QP on real hardware and exploring multi‑dimensional blending extensions.

---

### Key Claims & Contributions  

- **Claim 1 (Closed‑Form Safety)** – The optimisation problem (17) admits a closed‑form solution (21) – derived via KKT conditions – which yields a feasible μ for all states in \(C_I\).  *(Proof: Theorem 4; see §IV‑A).*  
- **Claim 2 (Safety & Bounds)** – The OI controller renders \(C_I \subseteq C_S\) forward invariant and respects input bounds. *(Proof: Theorem 3).*  
- **Claim 3 (Computational Savings)** – The OI controller requires integrating only \(3n\) ODEs versus \(n+n^2\) for the full bCBF‑QP, and no online QP solver.  *(Proof: Section IV‑B).*  
- **Claim 4 (Performance)** – In simulations, the OI controller outperforms naive blending by avoiding oscillation and giving smoother control signals.  *(Results in Fig. 2 & Fig. 3).*  
- **Contribution (Method)** – Introduction of the OI framework, bridging bCBFs and blending, with analytical derivation, safety proof, and demonstration on relevant flight‑control test‑beds.

---

### Definitions & Key Terms  

| Term | Definition |
|------|-------------|
| *Control‑Affine System* | \(\dot{x}=f(x)+g(x)u\) with \(x\in\mathbb{R}^n, u\in U\). |
| *Safety Set* | \(C_S=\{x: h(x)\ge0\}\) for CBF \(h\). |
| *Invariant* | Forward invariance: if \(x(0)\in C\) then \(x(t)\in C\) for all \(t>0\). |
| *Controlled Invariant* | Existence of a controller \(k\) such that \(C\) is forward invariant under \(\dot{x}=f(x)+g(x)k(x)\). |
| *Backup Set* | \(C_B=\{x: h_b(x)\ge 0\}\) with backup dynamics \(\dot{x}=f_{\!cl}(x)\). |
| *Control Barrier Function* | Function \(h\) satisfying the relative‑degree condition (2) on \(C_S\). |
| *Backup Control Barrier Function (bCBF)* | Extension of CBF that works under input bounds, defined by \(h_b\) and \(k_b\). |
| *Optimally Interpolated (OI) Controller* | \(k_m(x)=k_p(x)+\mu(x)(k_b(x)-k_p(x))\) with \(\mu\) solving (17). |
| *Key Classes* | Class \(K_\infty\) function \(\alpha\) continuous, strictly increasing, \(\alpha(0)=0\), \(\lim_{r\to\infty}\alpha(r)=\infty\). |
| *Closed‑Form μ* | μ* given by (21)/(26) depends only on \(a,b\) and the state. |
| *Dynamic Feasibility* | Feasibility of a QP implies existence of an input satisfying all constraints. |

---

### Important Figures & Tables  

- **Figure 1** – Flow diagram of the OI safety framework on the fixed‑wing geofence.  
- **Figure 2** – Comparative dynamics and control signal plots for the double integrator; demonstrates OI’s avoidance of the chattering observed with naive blending.  
- **Figure 3** – Fixed‑wing aircraft simulation: (a) nominal vs backup trajectory, (b) blended controller oscillation in rolling command, (c) control sliding, and (d) OI controller gating.  

---

### Limitations & Open Questions  

- **Single‑dimensional Interpolation**: The OI approach interpolates with a single μ; multi‑dimensional blending (vector μ) could yield better performance but lacks closed‑form and would require a full QP.  
- **Choice of Backup Set & Controller**: While the backup set and controller are central to safety, their design is still open‑ended and may impact the size of the safe set.  
- **Dependence on Discretisation**: The continuous closed‑form (26) is an idealisation; in practice a finite number of samples (N) is used, which may affect tightness.  
- **Implementation on Full Hardware**: While the authors claim feasibility on resource‑constrained platforms, real‑time integration on actual aircraft is left for future work.  
- **Robustness to Disturbances / Model Mismatch**: bCBFs and OI are derived under deterministic dynamics; handling uncertainty or noise remains an open research avenue.  

---

### References to Original Sections  

- BCBF foundation: §§II‑B, 3‑D.  
- Function‑based blending motivation: §III.  
- OI formulation & closed‑form: §IV‑A, Theorem 4.  
- Simulation details: §V‑A & V‑B.  
- Discussion of limitations: §VI.  

---

### Supplementary Material  

- **Source Code** – The authors provide simulation code for double integrator and aircraft at: https://github.com/davidvwijk/OI-CBF.  
- **Data Files** – Synthetic double integrator data and aircraft parameters included in the repository.  

---

**Executive Summary (Optional)**  

1. Introduced an *optimally interpolated* controller that blends nominal and backup actions for safety-critical control with bounded inputs.  
2. Derived a **closed‑form** solution for the blending weight, eliminating online QP solving.  
3. Reduced required ODE integrations from \(n+n^2\) to \(3n\).  
4. Verified safety mathematically and experimentally on double integrator and fixed‑wing aircraft.  
5. Brought performance comparable to bCBFs while avoiding oscillations inherent in naive blending.  
6. Open questions: extend to vector μ, handle uncertain dynamics, real‑world hardware validation.